'use strict';var _slicedToArray=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!(b&&c.length===b));d=!0);}catch(a){e=!0,f=a}finally{try{!d&&h['return']&&h['return']()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError('Invalid attempt to destructure non-iterable instance')}}(),_createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}var Binarizer=function(){function a(){_classCallCheck(this,a)}var b=Math.max,c=Math.min;return _createClass(a,null,[{key:'calculateRequiredBufferSize',value:function calculateRequiredBufferSize(b,c){var d=a._calculateBlockSize(b,c),e=_slicedToArray(d,3),f=e[1],g=e[2];return f*g}},{key:'_calculateBlockSize',value:function _calculateBlockSize(d,e){var f=Math.ceil,g=b(Math.floor(c(d,e)/a.TARGET_BLOCK_COUNT_ALONG_SHORTER_SIDE),a.MIN_BLOCK_SIZE),h=f(d/g),i=f(e/g);return[g,h,i]}},{key:'binarize',value:function binarize(d,e,f){var g=3<arguments.length&&void 0!==arguments[3]?arguments[3]:d,h=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null,k=a._calculateBlockSize(e,f),l=_slicedToArray(k,3),m=l[0],n=l[1],o=l[2],p=void 0;if(h){if(!(h instanceof Uint8ClampedArray)||h.byteLength!==n*o)throw Error('Illegal Buffer.');p=h}else p=new Uint8ClampedArray(n*o);for(var q=0;q<o;++q)for(var r,s=0;s<n;++s)r=a._calculateBlockThreshold(d,e,f,s,q,n,m,p),p[q*n+s]=r;for(var t=0;t<o;++t)for(var u,v=0;v<n;++v){u=0;for(var w=-2;2>=w;++w)for(var i=-2;2>=i;++i){var j=b(0,c(n-1,v+w)),x=b(0,c(o-1,t+i));u+=p[x*n+j]}a._applyThresholdToBlock(d,e,f,v,t,m,u/25,g)}}},{key:'_calculateBlockThreshold',value:function _calculateBlockThreshold(b,d,e,f,g,h,i,j){for(var p=255,q=0,r=c(f*i,d-i),s=c(g*i,e-i),t=s*d+r,u=0;u<i;++u){for(var v,w=0;w<i;++w)v=b[t+w],v<p&&(p=v),v>q&&(q=v);t+=d}if(max-min>a.MIN_DYNAMIC_RANGE)return(min+max)/2;if(0===f||0===g)return min/2;var k=g*h+f,l=j[k-1],m=j[k-h],n=h[k-h-1],o=(l+m+n)/3;return o>min?o:min/2}},{key:'_applyThresholdToBlock',value:function _applyThresholdToBlock(a,b,d,e,f,g,h){for(var i=7<arguments.length&&void 0!==arguments[7]?arguments[7]:a,j=c(e*g,b-g),k=c(f*g,d-g),l=k*b+j,m=0;m<g;++m){for(var n,o=0;o<g;++o)n=l+o,i[n]=a[n]<=h;l+=b}}}]),a}();Binarizer.TARGET_BLOCK_COUNT_ALONG_SHORTER_SIDE=40,Binarizer.MIN_BLOCK_SIZE=16,Binarizer.MIN_DYNAMIC_RANGE=24;
"use strict";var GridSampler={};GridSampler.checkAndNudgePoints=function(a,b){for(var c=Math.floor,d=qrcode.width,e=qrcode.height,f=!0,g=0;g<b.length&&f;g+=2){var h=c(b[g]),i=c(b[g+1]);if(-1>h||h>d||-1>i||i>e)throw"Error.checkAndNudgePoints ";f=!1,-1==h?(b[g]=0,f=!0):h==d&&(b[g]=d-1,f=!0),-1==i?(b[g+1]=0,f=!0):i==e&&(b[g+1]=e-1,f=!0)}f=!0;for(var g=b.length-2;0<=g&&f;g-=2){var h=c(b[g]),i=c(b[g+1]);if(-1>h||h>d||-1>i||i>e)throw"Error.checkAndNudgePoints ";f=!1,-1==h?(b[g]=0,f=!0):h==d&&(b[g]=d-1,f=!0),-1==i?(b[g+1]=0,f=!0):i==e&&(b[g+1]=e-1,f=!0)}},GridSampler.sampleGrid3=function(a,b,c){for(var d=Math.floor,e=new BitMatrix(b),f=Array(b<<1),g=0;g<b;g++){for(var h=f.length,i=g+0.5,j=0;j<h;j+=2)f[j]=(j>>1)+0.5,f[j+1]=i;c.transformPoints1(f),GridSampler.checkAndNudgePoints(a,f);try{for(var k,j=0;j<h;j+=2)k=a[d(f[j])+qrcode.width*d(f[j+1])],k&&e.set_Renamed(j>>1,g)}catch(a){throw"Error.checkAndNudgePoints"}}return e},GridSampler.sampleGridx=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){var s=PerspectiveTransform.quadrilateralToQuadrilateral(c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r);return GridSampler.sampleGrid3(a,b,s)};
"use strict";function ECB(a,b){this.count=a,this.dataCodewords=b,this.__defineGetter__("Count",function(){return this.count}),this.__defineGetter__("DataCodewords",function(){return this.dataCodewords})}function ECBlocks(a,b,c){this.ecCodewordsPerBlock=a,this.ecBlocks=c?[b,c]:Array(b),this.__defineGetter__("ECCodewordsPerBlock",function(){return this.ecCodewordsPerBlock}),this.__defineGetter__("TotalECCodewords",function(){return this.ecCodewordsPerBlock*this.NumBlocks}),this.__defineGetter__("NumBlocks",function(){for(var a=0,b=0;b<this.ecBlocks.length;b++)a+=this.ecBlocks[b].length;return a}),this.getECBlocks=function(){return this.ecBlocks}}function Version(a,b,c,d,e,f){this.versionNumber=a,this.alignmentPatternCenters=b,this.ecBlocks=[c,d,e,f];for(var g,h=0,j=c.ECCodewordsPerBlock,k=c.getECBlocks(),l=0;l<k.length;l++)g=k[l],h+=g.Count*(g.DataCodewords+j);this.totalCodewords=h,this.__defineGetter__("VersionNumber",function(){return this.versionNumber}),this.__defineGetter__("AlignmentPatternCenters",function(){return this.alignmentPatternCenters}),this.__defineGetter__("TotalCodewords",function(){return this.totalCodewords}),this.__defineGetter__("DimensionForVersion",function(){return 17+4*this.versionNumber}),this.buildFunctionPattern=function(){var a=this.DimensionForVersion,b=new BitMatrix(a);b.setRegion(0,0,9,9),b.setRegion(a-8,0,8,9),b.setRegion(0,a-8,9,8);for(var c,d=this.alignmentPatternCenters.length,e=0;e<d;e++){c=this.alignmentPatternCenters[e]-2;for(var f=0;f<d;f++)(0!=e||0!=f&&f!=d-1)&&(e!=d-1||0!=f)&&b.setRegion(this.alignmentPatternCenters[f]-2,c,5,5)}return b.setRegion(6,9,1,a-17),b.setRegion(9,6,a-17,1),6<this.versionNumber&&(b.setRegion(a-11,0,3,6),b.setRegion(0,a-11,6,3)),b},this.getECBlocksForLevel=function(a){return this.ecBlocks[a.ordinal()]}}Version.VERSION_DECODE_INFO=[31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017],Version.VERSIONS=buildVersions(),Version.getVersionForNumber=function(a){if(1>a||40<a)throw"ArgumentException";return Version.VERSIONS[a-1]},Version.getProvisionalVersionForDimension=function(a){if(1!=a%4)throw"Error getProvisionalVersionForDimension";try{return Version.getVersionForNumber(a-17>>2)}catch(a){throw"Error getVersionForNumber"}},Version.decodeVersionInformation=function(a){for(var b,c=4294967295,d=0,e=0;e<Version.VERSION_DECODE_INFO.length;e++){if(b=Version.VERSION_DECODE_INFO[e],b==a)return this.getVersionForNumber(e+7);var f=FormatInformation.numBitsDiffering(a,b);f<c&&(d=e+7,c=f)}return 3>=c?this.getVersionForNumber(d):null};function buildVersions(){return[new Version(1,[],new ECBlocks(7,new ECB(1,19)),new ECBlocks(10,new ECB(1,16)),new ECBlocks(13,new ECB(1,13)),new ECBlocks(17,new ECB(1,9))),new Version(2,[6,18],new ECBlocks(10,new ECB(1,34)),new ECBlocks(16,new ECB(1,28)),new ECBlocks(22,new ECB(1,22)),new ECBlocks(28,new ECB(1,16))),new Version(3,[6,22],new ECBlocks(15,new ECB(1,55)),new ECBlocks(26,new ECB(1,44)),new ECBlocks(18,new ECB(2,17)),new ECBlocks(22,new ECB(2,13))),new Version(4,[6,26],new ECBlocks(20,new ECB(1,80)),new ECBlocks(18,new ECB(2,32)),new ECBlocks(26,new ECB(2,24)),new ECBlocks(16,new ECB(4,9))),new Version(5,[6,30],new ECBlocks(26,new ECB(1,108)),new ECBlocks(24,new ECB(2,43)),new ECBlocks(18,new ECB(2,15),new ECB(2,16)),new ECBlocks(22,new ECB(2,11),new ECB(2,12))),new Version(6,[6,34],new ECBlocks(18,new ECB(2,68)),new ECBlocks(16,new ECB(4,27)),new ECBlocks(24,new ECB(4,19)),new ECBlocks(28,new ECB(4,15))),new Version(7,[6,22,38],new ECBlocks(20,new ECB(2,78)),new ECBlocks(18,new ECB(4,31)),new ECBlocks(18,new ECB(2,14),new ECB(4,15)),new ECBlocks(26,new ECB(4,13),new ECB(1,14))),new Version(8,[6,24,42],new ECBlocks(24,new ECB(2,97)),new ECBlocks(22,new ECB(2,38),new ECB(2,39)),new ECBlocks(22,new ECB(4,18),new ECB(2,19)),new ECBlocks(26,new ECB(4,14),new ECB(2,15))),new Version(9,[6,26,46],new ECBlocks(30,new ECB(2,116)),new ECBlocks(22,new ECB(3,36),new ECB(2,37)),new ECBlocks(20,new ECB(4,16),new ECB(4,17)),new ECBlocks(24,new ECB(4,12),new ECB(4,13))),new Version(10,[6,28,50],new ECBlocks(18,new ECB(2,68),new ECB(2,69)),new ECBlocks(26,new ECB(4,43),new ECB(1,44)),new ECBlocks(24,new ECB(6,19),new ECB(2,20)),new ECBlocks(28,new ECB(6,15),new ECB(2,16))),new Version(11,[6,30,54],new ECBlocks(20,new ECB(4,81)),new ECBlocks(30,new ECB(1,50),new ECB(4,51)),new ECBlocks(28,new ECB(4,22),new ECB(4,23)),new ECBlocks(24,new ECB(3,12),new ECB(8,13))),new Version(12,[6,32,58],new ECBlocks(24,new ECB(2,92),new ECB(2,93)),new ECBlocks(22,new ECB(6,36),new ECB(2,37)),new ECBlocks(26,new ECB(4,20),new ECB(6,21)),new ECBlocks(28,new ECB(7,14),new ECB(4,15))),new Version(13,[6,34,62],new ECBlocks(26,new ECB(4,107)),new ECBlocks(22,new ECB(8,37),new ECB(1,38)),new ECBlocks(24,new ECB(8,20),new ECB(4,21)),new ECBlocks(22,new ECB(12,11),new ECB(4,12))),new Version(14,[6,26,46,66],new ECBlocks(30,new ECB(3,115),new ECB(1,116)),new ECBlocks(24,new ECB(4,40),new ECB(5,41)),new ECBlocks(20,new ECB(11,16),new ECB(5,17)),new ECBlocks(24,new ECB(11,12),new ECB(5,13))),new Version(15,[6,26,48,70],new ECBlocks(22,new ECB(5,87),new ECB(1,88)),new ECBlocks(24,new ECB(5,41),new ECB(5,42)),new ECBlocks(30,new ECB(5,24),new ECB(7,25)),new ECBlocks(24,new ECB(11,12),new ECB(7,13))),new Version(16,[6,26,50,74],new ECBlocks(24,new ECB(5,98),new ECB(1,99)),new ECBlocks(28,new ECB(7,45),new ECB(3,46)),new ECBlocks(24,new ECB(15,19),new ECB(2,20)),new ECBlocks(30,new ECB(3,15),new ECB(13,16))),new Version(17,[6,30,54,78],new ECBlocks(28,new ECB(1,107),new ECB(5,108)),new ECBlocks(28,new ECB(10,46),new ECB(1,47)),new ECBlocks(28,new ECB(1,22),new ECB(15,23)),new ECBlocks(28,new ECB(2,14),new ECB(17,15))),new Version(18,[6,30,56,82],new ECBlocks(30,new ECB(5,120),new ECB(1,121)),new ECBlocks(26,new ECB(9,43),new ECB(4,44)),new ECBlocks(28,new ECB(17,22),new ECB(1,23)),new ECBlocks(28,new ECB(2,14),new ECB(19,15))),new Version(19,[6,30,58,86],new ECBlocks(28,new ECB(3,113),new ECB(4,114)),new ECBlocks(26,new ECB(3,44),new ECB(11,45)),new ECBlocks(26,new ECB(17,21),new ECB(4,22)),new ECBlocks(26,new ECB(9,13),new ECB(16,14))),new Version(20,[6,34,62,90],new ECBlocks(28,new ECB(3,107),new ECB(5,108)),new ECBlocks(26,new ECB(3,41),new ECB(13,42)),new ECBlocks(30,new ECB(15,24),new ECB(5,25)),new ECBlocks(28,new ECB(15,15),new ECB(10,16))),new Version(21,[6,28,50,72,94],new ECBlocks(28,new ECB(4,116),new ECB(4,117)),new ECBlocks(26,new ECB(17,42)),new ECBlocks(28,new ECB(17,22),new ECB(6,23)),new ECBlocks(30,new ECB(19,16),new ECB(6,17))),new Version(22,[6,26,50,74,98],new ECBlocks(28,new ECB(2,111),new ECB(7,112)),new ECBlocks(28,new ECB(17,46)),new ECBlocks(30,new ECB(7,24),new ECB(16,25)),new ECBlocks(24,new ECB(34,13))),new Version(23,[6,30,54,74,102],new ECBlocks(30,new ECB(4,121),new ECB(5,122)),new ECBlocks(28,new ECB(4,47),new ECB(14,48)),new ECBlocks(30,new ECB(11,24),new ECB(14,25)),new ECBlocks(30,new ECB(16,15),new ECB(14,16))),new Version(24,[6,28,54,80,106],new ECBlocks(30,new ECB(6,117),new ECB(4,118)),new ECBlocks(28,new ECB(6,45),new ECB(14,46)),new ECBlocks(30,new ECB(11,24),new ECB(16,25)),new ECBlocks(30,new ECB(30,16),new ECB(2,17))),new Version(25,[6,32,58,84,110],new ECBlocks(26,new ECB(8,106),new ECB(4,107)),new ECBlocks(28,new ECB(8,47),new ECB(13,48)),new ECBlocks(30,new ECB(7,24),new ECB(22,25)),new ECBlocks(30,new ECB(22,15),new ECB(13,16))),new Version(26,[6,30,58,86,114],new ECBlocks(28,new ECB(10,114),new ECB(2,115)),new ECBlocks(28,new ECB(19,46),new ECB(4,47)),new ECBlocks(28,new ECB(28,22),new ECB(6,23)),new ECBlocks(30,new ECB(33,16),new ECB(4,17))),new Version(27,[6,34,62,90,118],new ECBlocks(30,new ECB(8,122),new ECB(4,123)),new ECBlocks(28,new ECB(22,45),new ECB(3,46)),new ECBlocks(30,new ECB(8,23),new ECB(26,24)),new ECBlocks(30,new ECB(12,15),new ECB(28,16))),new Version(28,[6,26,50,74,98,122],new ECBlocks(30,new ECB(3,117),new ECB(10,118)),new ECBlocks(28,new ECB(3,45),new ECB(23,46)),new ECBlocks(30,new ECB(4,24),new ECB(31,25)),new ECBlocks(30,new ECB(11,15),new ECB(31,16))),new Version(29,[6,30,54,78,102,126],new ECBlocks(30,new ECB(7,116),new ECB(7,117)),new ECBlocks(28,new ECB(21,45),new ECB(7,46)),new ECBlocks(30,new ECB(1,23),new ECB(37,24)),new ECBlocks(30,new ECB(19,15),new ECB(26,16))),new Version(30,[6,26,52,78,104,130],new ECBlocks(30,new ECB(5,115),new ECB(10,116)),new ECBlocks(28,new ECB(19,47),new ECB(10,48)),new ECBlocks(30,new ECB(15,24),new ECB(25,25)),new ECBlocks(30,new ECB(23,15),new ECB(25,16))),new Version(31,[6,30,56,82,108,134],new ECBlocks(30,new ECB(13,115),new ECB(3,116)),new ECBlocks(28,new ECB(2,46),new ECB(29,47)),new ECBlocks(30,new ECB(42,24),new ECB(1,25)),new ECBlocks(30,new ECB(23,15),new ECB(28,16))),new Version(32,[6,34,60,86,112,138],new ECBlocks(30,new ECB(17,115)),new ECBlocks(28,new ECB(10,46),new ECB(23,47)),new ECBlocks(30,new ECB(10,24),new ECB(35,25)),new ECBlocks(30,new ECB(19,15),new ECB(35,16))),new Version(33,[6,30,58,86,114,142],new ECBlocks(30,new ECB(17,115),new ECB(1,116)),new ECBlocks(28,new ECB(14,46),new ECB(21,47)),new ECBlocks(30,new ECB(29,24),new ECB(19,25)),new ECBlocks(30,new ECB(11,15),new ECB(46,16))),new Version(34,[6,34,62,90,118,146],new ECBlocks(30,new ECB(13,115),new ECB(6,116)),new ECBlocks(28,new ECB(14,46),new ECB(23,47)),new ECBlocks(30,new ECB(44,24),new ECB(7,25)),new ECBlocks(30,new ECB(59,16),new ECB(1,17))),new Version(35,[6,30,54,78,102,126,150],new ECBlocks(30,new ECB(12,121),new ECB(7,122)),new ECBlocks(28,new ECB(12,47),new ECB(26,48)),new ECBlocks(30,new ECB(39,24),new ECB(14,25)),new ECBlocks(30,new ECB(22,15),new ECB(41,16))),new Version(36,[6,24,50,76,102,128,154],new ECBlocks(30,new ECB(6,121),new ECB(14,122)),new ECBlocks(28,new ECB(6,47),new ECB(34,48)),new ECBlocks(30,new ECB(46,24),new ECB(10,25)),new ECBlocks(30,new ECB(2,15),new ECB(64,16))),new Version(37,[6,28,54,80,106,132,158],new ECBlocks(30,new ECB(17,122),new ECB(4,123)),new ECBlocks(28,new ECB(29,46),new ECB(14,47)),new ECBlocks(30,new ECB(49,24),new ECB(10,25)),new ECBlocks(30,new ECB(24,15),new ECB(46,16))),new Version(38,[6,32,58,84,110,136,162],new ECBlocks(30,new ECB(4,122),new ECB(18,123)),new ECBlocks(28,new ECB(13,46),new ECB(32,47)),new ECBlocks(30,new ECB(48,24),new ECB(14,25)),new ECBlocks(30,new ECB(42,15),new ECB(32,16))),new Version(39,[6,26,54,82,110,138,166],new ECBlocks(30,new ECB(20,117),new ECB(4,118)),new ECBlocks(28,new ECB(40,47),new ECB(7,48)),new ECBlocks(30,new ECB(43,24),new ECB(22,25)),new ECBlocks(30,new ECB(10,15),new ECB(67,16))),new Version(40,[6,30,58,86,114,142,170],new ECBlocks(30,new ECB(19,118),new ECB(6,119)),new ECBlocks(28,new ECB(18,47),new ECB(31,48)),new ECBlocks(30,new ECB(34,24),new ECB(34,25)),new ECBlocks(30,new ECB(20,15),new ECB(61,16)))]}
"use strict";function PerspectiveTransform(a,b,c,d,e,f,g,h,i){this.a11=a,this.a12=d,this.a13=g,this.a21=b,this.a22=e,this.a23=h,this.a31=c,this.a32=f,this.a33=i,this.transformPoints1=function(a){for(var b=a.length,c=this.a11,d=this.a12,e=this.a13,f=this.a21,g=this.a22,h=this.a23,j=this.a31,k=this.a32,l=this.a33,m=0;m<b;m+=2){var i=a[m],n=a[m+1],o=e*i+h*n+l;a[m]=(c*i+f*n+j)/o,a[m+1]=(d*i+g*n+k)/o}},this.transformPoints2=function(a,b){for(var c=a.length,d=0;d<c;d++){var e=a[d],f=b[d],g=this.a13*e+this.a23*f+this.a33;a[d]=(this.a11*e+this.a21*f+this.a31)/g,b[d]=(this.a12*e+this.a22*f+this.a32)/g}},this.buildAdjoint=function(){return new PerspectiveTransform(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)},this.times=function(a){return new PerspectiveTransform(this.a11*a.a11+this.a21*a.a12+this.a31*a.a13,this.a11*a.a21+this.a21*a.a22+this.a31*a.a23,this.a11*a.a31+this.a21*a.a32+this.a31*a.a33,this.a12*a.a11+this.a22*a.a12+this.a32*a.a13,this.a12*a.a21+this.a22*a.a22+this.a32*a.a23,this.a12*a.a31+this.a22*a.a32+this.a32*a.a33,this.a13*a.a11+this.a23*a.a12+this.a33*a.a13,this.a13*a.a21+this.a23*a.a22+this.a33*a.a23,this.a13*a.a31+this.a23*a.a32+this.a33*a.a33)}}PerspectiveTransform.quadrilateralToQuadrilateral=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q=this.quadrilateralToSquare(a,b,c,d,e,f,g,h),r=this.squareToQuadrilateral(i,j,k,l,m,n,o,p);return r.times(q)},PerspectiveTransform.squareToQuadrilateral=function(a,b,c,d,e,f,g,h){var i=h-f,j=b-d+f-h;if(0==i&&0==j)return new PerspectiveTransform(c-a,e-c,a,d-b,f-d,b,0,0,1);var k=c-e,l=g-e,m=a-c+e-g,n=d-f,o=k*i-l*n,p=(m*i-l*j)/o,q=(k*j-m*n)/o;return new PerspectiveTransform(c-a+p*c,g-a+q*g,a,d-b+p*d,h-b+q*h,b,p,q,1)},PerspectiveTransform.quadrilateralToSquare=function(a,b,c,d,e,f,g,h){return this.squareToQuadrilateral(a,b,c,d,e,f,g,h).buildAdjoint()};function DetectorResult(a,b){this.bits=a,this.points=b}function Detector(a){var b=Math.floor,c=Math.sqrt;this.image=a,this.resultPointCallback=null,this.sizeOfBlackWhiteBlackRun=function(a,b,d,e){var f=Math.abs,g=f(e-b)>f(d-a);if(g){var h=a;a=b,b=h,h=d,d=e,e=h}for(var i=f(d-a),j=f(e-b),k=-i>>1,l=b<e?1:-1,m=a<d?1:-1,n=0,o=a,p=b;o!=d;o+=m){var q=g?p:o,r=g?o:p;if(1==n?this.image[q+r*qrcode.width]&&n++:!this.image[q+r*qrcode.width]&&n++,3==n){var s=o-a,t=p-b;return c(s*s+t*t)}if(k+=j,0<k){if(p==e)break;p+=l,k-=i}}var u=d-a,v=e-b;return c(u*u+v*v)},this.sizeOfBlackWhiteBlackRunBothWays=function(a,c,d,e){var f=this.sizeOfBlackWhiteBlackRun(a,c,d,e),g=1,h=a-(d-a);0>h?(g=a/(a-h),h=0):h>=qrcode.width&&(g=(qrcode.width-1-a)/(h-a),h=qrcode.width-1);var i=b(c-(e-c)*g);return g=1,0>i?(g=c/(c-i),i=0):i>=qrcode.height&&(g=(qrcode.height-1-c)/(i-c),i=qrcode.height-1),h=b(a+(h-a)*g),f+=this.sizeOfBlackWhiteBlackRun(a,c,h,i),f-1},this.calculateModuleSizeOneWay=function(a,c){var d=this.sizeOfBlackWhiteBlackRunBothWays(b(a.X),b(a.Y),b(c.X),b(c.Y)),e=this.sizeOfBlackWhiteBlackRunBothWays(b(c.X),b(c.Y),b(a.X),b(a.Y));return isNaN(d)?e/7:isNaN(e)?d/7:(d+e)/14},this.calculateModuleSize=function(a,b,c){return(this.calculateModuleSizeOneWay(a,b)+this.calculateModuleSizeOneWay(a,c))/2},this.distance=function(a,b){var d=a.X-b.X,e=a.Y-b.Y;return c(d*d+e*e)},this.computeDimension=function(a,b,c,d){var e=Math.round,f=e(this.distance(a,b)/d),g=e(this.distance(a,c)/d),h=(f+g>>1)+7;switch(3&h){case 0:h++;break;case 2:h--;break;case 3:throw"Error";}return h},this.findAlignmentInRegion=function(a,c,d,e){var f=Math.min,g=Math.max,h=b(e*a),i=g(0,c-h),j=f(qrcode.width-1,c+h);if(j-i<3*a)throw"Error";var k=g(0,d-h),l=f(qrcode.height-1,d+h),m=new AlignmentPatternFinder(this.image,i,k,j-i,l-k,a,this.resultPointCallback);return m.find()},this.createTransform=function(a,b,c,d,e){var f,g,h,i,j=e-3.5;null==d?(f=b.X-a.X+c.X,g=b.Y-a.Y+c.Y,h=i=j):(f=d.X,g=d.Y,h=i=j-3);var k=PerspectiveTransform.quadrilateralToQuadrilateral(3.5,3.5,j,3.5,h,i,3.5,j,a.X,a.Y,b.X,b.Y,f,g,c.X,c.Y);return k},this.sampleGrid=function(a,b,c){var d=GridSampler;return d.sampleGrid3(a,c,b)},this.processFinderPatternInfo=function(a){var c=a.TopLeft,d=a.TopRight,e=a.BottomLeft,f=this.calculateModuleSize(c,d,e);if(1>f)throw"Error";var g=this.computeDimension(c,d,e,f),h=Version.getProvisionalVersionForDimension(g),j=h.DimensionForVersion-7,k=null;if(0<h.AlignmentPatternCenters.length)for(var l=d.X-c.X+e.X,m=d.Y-c.Y+e.Y,n=1-3/j,o=b(c.X+n*(l-c.X)),p=b(c.Y+n*(m-c.Y)),q=4;16>=q;q<<=1){k=this.findAlignmentInRegion(f,o,p,q);break}var i,r=this.createTransform(c,d,e,k,g),s=this.sampleGrid(this.image,r,g);return i=null==k?[e,c,d]:[e,c,d,k],new DetectorResult(s,i)},this.detect=function(){var a=new FinderPatternFinder().findFinderPattern(this.image);return this.processFinderPatternInfo(a)}}
"use strict";var FORMAT_INFO_MASK_QR=21522,FORMAT_INFO_DECODE_LOOKUP=[[21522,0],[20773,1],[24188,2],[23371,3],[17913,4],[16590,5],[20375,6],[19104,7],[30660,8],[29427,9],[32170,10],[30877,11],[26159,12],[25368,13],[27713,14],[26998,15],[5769,16],[5054,17],[7399,18],[6608,19],[1890,20],[597,21],[3340,22],[2107,23],[13663,24],[12392,25],[16177,26],[14854,27],[9396,28],[8579,29],[11994,30],[11245,31]],BITS_SET_IN_HALF_BYTE=[0,1,1,2,1,2,2,3,1,2,2,3,2,3,3,4];function FormatInformation(a){this.errorCorrectionLevel=ErrorCorrectionLevel.forBits(3&a>>3),this.dataMask=7&a,this.__defineGetter__("ErrorCorrectionLevel",function(){return this.errorCorrectionLevel}),this.__defineGetter__("DataMask",function(){return this.dataMask}),this.GetHashCode=function(){return this.errorCorrectionLevel.ordinal()<<3|this.dataMask},this.Equals=function(a){var b=a;return this.errorCorrectionLevel==b.errorCorrectionLevel&&this.dataMask==b.dataMask}}FormatInformation.numBitsDiffering=function(c,a){return c^=a,BITS_SET_IN_HALF_BYTE[15&c]+BITS_SET_IN_HALF_BYTE[15&URShift(c,4)]+BITS_SET_IN_HALF_BYTE[15&URShift(c,8)]+BITS_SET_IN_HALF_BYTE[15&URShift(c,12)]+BITS_SET_IN_HALF_BYTE[15&URShift(c,16)]+BITS_SET_IN_HALF_BYTE[15&URShift(c,20)]+BITS_SET_IN_HALF_BYTE[15&URShift(c,24)]+BITS_SET_IN_HALF_BYTE[15&URShift(c,28)]},FormatInformation.decodeFormatInformation=function(a){var b=FormatInformation.doDecodeFormatInformation(a);return null==b?FormatInformation.doDecodeFormatInformation(a^FORMAT_INFO_MASK_QR):b},FormatInformation.doDecodeFormatInformation=function(a){for(var b=4294967295,c=0,d=0;d<FORMAT_INFO_DECODE_LOOKUP.length;d++){var e=FORMAT_INFO_DECODE_LOOKUP[d],f=e[0];if(f==a)return new FormatInformation(e[1]);var g=this.numBitsDiffering(a,f);g<b&&(c=e[1],b=g)}return 3>=b?new FormatInformation(c):null};
"use strict";function ErrorCorrectionLevel(a,b,c){this.ordinal_Renamed_Field=a,this.bits=b,this.name=c,this.__defineGetter__("Bits",function(){return this.bits}),this.__defineGetter__("Name",function(){return this.name}),this.ordinal=function(){return this.ordinal_Renamed_Field}}ErrorCorrectionLevel.forBits=function(a){if(0>a||a>=FOR_BITS.length)throw"ArgumentException";return FOR_BITS[a]};var L=new ErrorCorrectionLevel(0,1,"L"),M=new ErrorCorrectionLevel(1,0,"M"),Q=new ErrorCorrectionLevel(2,3,"Q"),H=new ErrorCorrectionLevel(3,2,"H"),FOR_BITS=[M,L,H,Q];
"use strict";function BitMatrix(a,b){if(b||(b=a),1>a||1>b)throw"Both dimensions must be greater than 0";this.width=a,this.height=b;var c=a>>5;0!=(31&a)&&c++,this.rowSize=c,this.bits=Array(c*b);for(var d=0;d<this.bits.length;d++)this.bits[d]=0;this.__defineGetter__("Width",function(){return this.width}),this.__defineGetter__("Height",function(){return this.height}),this.__defineGetter__("Dimension",function(){if(this.width!=this.height)throw"Can't call getDimension() on a non-square matrix";return this.width}),this.get_Renamed=function(a,b){var c=b*this.rowSize+(a>>5);return 0!=(1&URShift(this.bits[c],31&a))},this.set_Renamed=function(a,b){var c=b*this.rowSize+(a>>5);this.bits[c]|=1<<(31&a)},this.flip=function(a,b){var c=b*this.rowSize+(a>>5);this.bits[c]^=1<<(31&a)},this.clear=function(){for(var a=this.bits.length,b=0;b<a;b++)this.bits[b]=0},this.setRegion=function(a,b,c,d){if(0>b||0>a)throw"Left and top must be nonnegative";if(1>d||1>c)throw"Height and width must be at least 1";var e=a+c,f=b+d;if(f>this.height||e>this.width)throw"The region must fit inside the matrix";for(var g,h=b;h<f;h++){g=h*this.rowSize;for(var i=a;i<e;i++)this.bits[g+(i>>5)]|=1<<(31&i)}}}
"use strict";function DataBlock(a,b){this.numDataCodewords=a,this.codewords=b,this.__defineGetter__("NumDataCodewords",function(){return this.numDataCodewords}),this.__defineGetter__("Codewords",function(){return this.codewords})}DataBlock.getDataBlocks=function(a,b,c){if(a.length!=b.TotalCodewords)throw"ArgumentException";for(var d=b.getECBlocksForLevel(c),e=0,f=d.getECBlocks(),g=0;g<f.length;g++)e+=f[g].Count;for(var h,i=Array(e),k=0,l=0;l<f.length;l++){h=f[l];for(var g=0;g<h.Count;g++){var j=h.DataCodewords,m=d.ECCodewordsPerBlock+j;i[k++]=new DataBlock(j,Array(m))}}for(var n=i[0].codewords.length,o=i.length-1;0<=o;){var p=i[o].codewords.length;if(p==n)break;o--}o++;for(var q=n-d.ECCodewordsPerBlock,r=0,g=0;g<q;g++)for(var l=0;l<k;l++)i[l].codewords[g]=a[r++];for(var l=o;l<k;l++)i[l].codewords[q]=a[r++];for(var s=i[0].codewords.length,g=q;g<s;g++)for(var t,l=0;l<k;l++)t=l<o?g:g+1,i[l].codewords[t]=a[r++];return i};
"use strict";function BitMatrixParser(a){var b=a.Dimension;if(21>b||1!=(3&b))throw"Error BitMatrixParser";this.bitMatrix=a,this.parsedVersion=null,this.parsedFormatInfo=null,this.copyBit=function(a,b,c){return this.bitMatrix.get_Renamed(a,b)?1|c<<1:c<<1},this.readFormatInformation=function(){if(null!=this.parsedFormatInfo)return this.parsedFormatInfo;for(var a=0,b=0;6>b;b++)a=this.copyBit(b,8,a);a=this.copyBit(7,8,a),a=this.copyBit(8,8,a),a=this.copyBit(8,7,a);for(var c=5;0<=c;c--)a=this.copyBit(8,c,a);if(this.parsedFormatInfo=FormatInformation.decodeFormatInformation(a),null!=this.parsedFormatInfo)return this.parsedFormatInfo;var d=this.bitMatrix.Dimension;a=0;for(var b=d-1;b>=d-8;b--)a=this.copyBit(b,8,a);for(var c=d-7;c<d;c++)a=this.copyBit(8,c,a);if(this.parsedFormatInfo=FormatInformation.decodeFormatInformation(a),null!=this.parsedFormatInfo)return this.parsedFormatInfo;throw"Error readFormatInformation"},this.readVersion=function(){if(null!=this.parsedVersion)return this.parsedVersion;var a=this.bitMatrix.Dimension,b=a-17>>2;if(6>=b)return Version.getVersionForNumber(b);for(var c=0,d=a-11,e=5;0<=e;e--)for(var f=a-9;f>=d;f--)c=this.copyBit(f,e,c);if(this.parsedVersion=Version.decodeVersionInformation(c),null!=this.parsedVersion&&this.parsedVersion.DimensionForVersion==a)return this.parsedVersion;c=0;for(var f=5;0<=f;f--)for(var e=a-9;e>=d;e--)c=this.copyBit(f,e,c);if(this.parsedVersion=Version.decodeVersionInformation(c),null!=this.parsedVersion&&this.parsedVersion.DimensionForVersion==a)return this.parsedVersion;throw"Error readVersion"},this.readCodewords=function(){var a=this.readFormatInformation(),b=this.readVersion(),c=DataMask.forReference(a.DataMask),d=this.bitMatrix.Dimension;c.unmaskBitMatrix(this.bitMatrix,d);for(var e=b.buildFunctionPattern(),f=!0,g=Array(b.TotalCodewords),h=0,k=0,l=0,m=d-1;0<m;m-=2){6==m&&m--;for(var j,i=0;i<d;i++){j=f?d-1-i:i;for(var n=0;2>n;n++)e.get_Renamed(m-n,j)||(l++,k<<=1,this.bitMatrix.get_Renamed(m-n,j)&&(k|=1),8==l&&(g[h++]=k,l=0,k=0))}f^=!0}if(h!=b.TotalCodewords)throw"Error readCodewords";return g}}
"use strict";var DataMask={};DataMask.forReference=function(a){if(0>a||7<a)throw"System.ArgumentException";return DataMask.DATA_MASKS[a]};function DataMask000(){this.unmaskBitMatrix=function(a,b){for(var c=0;c<b;c++)for(var d=0;d<b;d++)this.isMasked(c,d)&&a.flip(d,c)},this.isMasked=function(a,b){return 0==(1&a+b)}}function DataMask001(){this.unmaskBitMatrix=function(a,b){for(var c=0;c<b;c++)for(var d=0;d<b;d++)this.isMasked(c,d)&&a.flip(d,c)},this.isMasked=function(a){return 0==(1&a)}}function DataMask010(){this.unmaskBitMatrix=function(a,b){for(var c=0;c<b;c++)for(var d=0;d<b;d++)this.isMasked(c,d)&&a.flip(d,c)},this.isMasked=function(a,b){return 0==b%3}}function DataMask011(){this.unmaskBitMatrix=function(a,b){for(var c=0;c<b;c++)for(var d=0;d<b;d++)this.isMasked(c,d)&&a.flip(d,c)},this.isMasked=function(a,b){return 0==(a+b)%3}}function DataMask100(){this.unmaskBitMatrix=function(a,b){for(var c=0;c<b;c++)for(var d=0;d<b;d++)this.isMasked(c,d)&&a.flip(d,c)},this.isMasked=function(a,b){return 0==(1&URShift(a,1)+b/3)}}function DataMask101(){this.unmaskBitMatrix=function(a,b){for(var c=0;c<b;c++)for(var d=0;d<b;d++)this.isMasked(c,d)&&a.flip(d,c)},this.isMasked=function(a,b){var c=a*b;return 0==(1&c)+c%3}}function DataMask110(){this.unmaskBitMatrix=function(a,b){for(var c=0;c<b;c++)for(var d=0;d<b;d++)this.isMasked(c,d)&&a.flip(d,c)},this.isMasked=function(a,b){var c=a*b;return 0==(1&(1&c)+c%3)}}function DataMask111(){this.unmaskBitMatrix=function(a,b){for(var c=0;c<b;c++)for(var d=0;d<b;d++)this.isMasked(c,d)&&a.flip(d,c)},this.isMasked=function(a,b){return 0==(1&(1&a+b)+a*b%3)}}DataMask.DATA_MASKS=[new DataMask000,new DataMask001,new DataMask010,new DataMask011,new DataMask100,new DataMask101,new DataMask110,new DataMask111];
"use strict";function ReedSolomonDecoder(a){this.field=a,this.decode=function(a,b){for(var c=new GF256Poly(this.field,a),d=Array(b),e=0;e<d.length;e++)d[e]=0;for(var f,g=!1,h=!0,e=0;e<b;e++)f=c.evaluateAt(this.field.exp(e)),d[d.length-1-e]=f,0!=f&&(h=!1);if(!h)for(var i,j=new GF256Poly(this.field,d),k=this.runEuclideanAlgorithm(this.field.buildMonomial(b,1),j,b),l=k[0],m=k[1],n=this.findErrorLocations(l),o=this.findErrorMagnitudes(m,n,g),e=0;e<n.length;e++){if(i=a.length-1-this.field.log(n[e]),0>i)throw"ReedSolomonException Bad error location";a[i]=GF256.addOrSubtract(a[i],o[e])}},this.runEuclideanAlgorithm=function(c,a,b){if(c.Degree<a.Degree){var d=c;c=a,a=d}for(var e=c,f=a,g=this.field.One,h=this.field.Zero,i=this.field.Zero,j=this.field.One;f.Degree>=Math.floor(b/2);){var k=e,l=g,m=i;if(e=f,g=h,i=j,e.Zero)throw"r_{i-1} was zero";f=k;for(var n=this.field.Zero,o=e.getCoefficient(e.Degree),p=this.field.inverse(o);f.Degree>=e.Degree&&!f.Zero;){var q=f.Degree-e.Degree,r=this.field.multiply(f.getCoefficient(f.Degree),p);n=n.addOrSubtract(this.field.buildMonomial(q,r)),f=f.addOrSubtract(e.multiplyByMonomial(q,r))}h=n.multiply1(g).addOrSubtract(l),j=n.multiply1(i).addOrSubtract(m)}var s=j.getCoefficient(0);if(0==s)throw"ReedSolomonException sigmaTilde(0) was zero";var t=this.field.inverse(s),u=j.multiply2(t),v=f.multiply2(t);return[u,v]},this.findErrorLocations=function(a){var b=a.Degree;if(1==b)return Array(a.getCoefficient(1));for(var c=Array(b),d=0,e=1;256>e&&d<b;e++)0==a.evaluateAt(e)&&(c[d]=this.field.inverse(e),d++);if(d!=b)throw"Error locator degree does not match number of roots";return c},this.findErrorMagnitudes=function(a,b,c){for(var d=b.length,e=Array(d),f=0;f<d;f++){for(var g=this.field.inverse(b[f]),h=1,i=0;i<d;i++)f!=i&&(h=this.field.multiply(h,GF256.addOrSubtract(1,this.field.multiply(b[i],g))));e[f]=this.field.multiply(a.evaluateAt(g),this.field.inverse(h)),c&&(e[f]=this.field.multiply(e[f],g))}return e}}
"use strict";function GF256Poly(a,b){if(null==b||0==b.length)throw"System.ArgumentException";this.field=a;var c=b.length;if(1<c&&0==b[0]){for(var d=1;d<c&&0==b[d];)d++;if(d==c)this.coefficients=a.Zero.coefficients;else{this.coefficients=Array(c-d);for(var e=0;e<this.coefficients.length;e++)this.coefficients[e]=0;for(var f=0;f<this.coefficients.length;f++)this.coefficients[f]=b[d+f]}}else this.coefficients=b;this.__defineGetter__("Zero",function(){return 0==this.coefficients[0]}),this.__defineGetter__("Degree",function(){return this.coefficients.length-1}),this.__defineGetter__("Coefficients",function(){return this.coefficients}),this.getCoefficient=function(a){return this.coefficients[this.coefficients.length-1-a]},this.evaluateAt=function(b){if(0==b)return this.getCoefficient(0);var a=this.coefficients.length;if(1==b){for(var c=0,d=0;d<a;d++)c=GF256.addOrSubtract(c,this.coefficients[d]);return c}for(var e=this.coefficients[0],d=1;d<a;d++)e=GF256.addOrSubtract(this.field.multiply(b,e),this.coefficients[d]);return e},this.addOrSubtract=function(b){if(this.field!=b.field)throw"GF256Polys do not have same GF256 field";if(this.Zero)return b;if(b.Zero)return this;var c=this.coefficients,d=b.coefficients;if(c.length>d.length){var e=c;c=d,d=e}for(var f=Array(d.length),g=d.length-c.length,h=0;h<g;h++)f[h]=d[h];for(var j=g;j<d.length;j++)f[j]=GF256.addOrSubtract(c[j-g],d[j]);return new GF256Poly(a,f)},this.multiply1=function(a){if(this.field!=a.field)throw"GF256Polys do not have same GF256 field";if(this.Zero||a.Zero)return this.field.Zero;for(var b,c=this.coefficients,d=c.length,e=a.coefficients,f=e.length,g=Array(d+f-1),h=0;h<d;h++){b=c[h];for(var i=0;i<f;i++)g[h+i]=GF256.addOrSubtract(g[h+i],this.field.multiply(b,e[i]))}return new GF256Poly(this.field,g)},this.multiply2=function(a){if(0==a)return this.field.Zero;if(1==a)return this;for(var b=this.coefficients.length,c=Array(b),d=0;d<b;d++)c[d]=this.field.multiply(this.coefficients[d],a);return new GF256Poly(this.field,c)},this.multiplyByMonomial=function(a,b){if(0>a)throw"System.ArgumentException";if(0==b)return this.field.Zero;for(var c=this.coefficients.length,d=Array(c+a),e=0;e<d.length;e++)d[e]=0;for(var e=0;e<c;e++)d[e]=this.field.multiply(this.coefficients[e],b);return new GF256Poly(this.field,d)},this.divide=function(a){if(this.field!=a.field)throw"GF256Polys do not have same GF256 field";if(a.Zero)throw"Divide by 0";for(var b=this.field.Zero,c=this,d=a.getCoefficient(a.Degree),e=this.field.inverse(d);c.Degree>=a.Degree&&!c.Zero;){var f=c.Degree-a.Degree,g=this.field.multiply(c.getCoefficient(c.Degree),e),h=a.multiplyByMonomial(f,g),i=this.field.buildMonomial(f,g);b=b.addOrSubtract(i),c=c.addOrSubtract(h)}return[b,c]}}
"use strict";function GF256(a){this.expTable=Array(256),this.logTable=Array(256);for(var b=1,c=0;256>c;c++)this.expTable[c]=b,b<<=1,256<=b&&(b^=a);for(var c=0;255>c;c++)this.logTable[this.expTable[c]]=c;var d=[,];d[0]=0,this.zero=new GF256Poly(this,Array(d));var e=[,];e[0]=1,this.one=new GF256Poly(this,Array(e)),this.__defineGetter__("Zero",function(){return this.zero}),this.__defineGetter__("One",function(){return this.one}),this.buildMonomial=function(a,b){if(0>a)throw"System.ArgumentException";if(0==b)return this.zero;for(var c=Array(a+1),d=0;d<c.length;d++)c[d]=0;return c[0]=b,new GF256Poly(this,c)},this.exp=function(b){return this.expTable[b]},this.log=function(b){if(0==b)throw"System.ArgumentException";return this.logTable[b]},this.inverse=function(b){if(0==b)throw"System.ArithmeticException";return this.expTable[255-this.logTable[b]]},this.multiply=function(c,a){return 0==c||0==a?0:1==c?a:1==a?c:this.expTable[(this.logTable[c]+this.logTable[a])%255]}}GF256.QR_CODE_FIELD=new GF256(285),GF256.DATA_MATRIX_FIELD=new GF256(301),GF256.addOrSubtract=function(c,a){return c^a};
"use strict";var Decoder={};Decoder.rsDecoder=new ReedSolomonDecoder(GF256.QR_CODE_FIELD),Decoder.correctErrors=function(a,b){for(var c=a.length,d=Array(c),e=0;e<c;e++)d[e]=255&a[e];var f=a.length-b;try{Decoder.rsDecoder.decode(d,f)}catch(a){throw a}for(var e=0;e<b;e++)a[e]=d[e]},Decoder.decode=function(a){for(var b=new BitMatrixParser(a),c=b.readVersion(),d=b.readFormatInformation().ErrorCorrectionLevel,e=b.readCodewords(),f=DataBlock.getDataBlocks(e,c,d),g=0,h=0;h<f.length;h++)g+=f[h].NumDataCodewords;for(var i=Array(g),k=0,l=0;l<f.length;l++){var j=f[l],m=j.Codewords,n=j.NumDataCodewords;Decoder.correctErrors(m,n);for(var h=0;h<n;h++)i[k++]=m[h]}var o=new QRCodeDataBlockReader(i,c.VersionNumber,d.Bits);return o};
"use strict";var qrcode={};qrcode.imagedata=null,qrcode.width=0,qrcode.height=0,qrcode.qrCodeSymbol=null,qrcode.debug=!1,qrcode.maxImgSize=1048576,qrcode.sizeOfDataLengthInfo=[[10,9,8,8],[12,11,16,10],[14,13,16,12]],qrcode.callback=null,qrcode.decode=function(a){if(0==arguments.length){if(qrcode.canvas_qr2)var b=qrcode.canvas_qr2,c=qrcode.qrcontext2;else var b=document.getElementById("qr-canvas"),c=b.getContext("2d");return qrcode.width=b.width,qrcode.height=b.height,qrcode.imagedata=c.getImageData(0,0,qrcode.width,qrcode.height),qrcode.result=qrcode.process(c),null!=qrcode.callback&&qrcode.callback(qrcode.result),qrcode.result}var d=new Image;d.crossOrigin="Anonymous",d.onload=function(){var a=document.getElementById("out-canvas");if(null!=a){var b=a.getContext("2d");b.clearRect(0,0,320,240),b.drawImage(d,0,0,320,240)}var c=document.createElement("canvas"),e=c.getContext("2d"),f=d.height,g=d.width;if(d.width*d.height>qrcode.maxImgSize){var h=d.width/d.height;f=Math.sqrt(qrcode.maxImgSize/h),g=h*f}c.width=g,c.height=f,e.drawImage(d,0,0,c.width,c.height),qrcode.width=c.width,qrcode.height=c.height;try{qrcode.imagedata=e.getImageData(0,0,c.width,c.height)}catch(a){return qrcode.result="Cross domain image reading not supported in your browser! Save it to your computer then drag and drop the file!",void(null!=qrcode.callback&&qrcode.callback(qrcode.result))}try{qrcode.result=qrcode.process(e)}catch(a){console.log(a),qrcode.result="error decoding QR Code"}null!=qrcode.callback&&qrcode.callback(qrcode.result)},d.onerror=function(){null!=qrcode.callback&&qrcode.callback("Failed to load the image")},d.src=a},qrcode.isUrl=function(a){var b=/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/;return b.test(a)},qrcode.decode_url=function(a){var b="";try{b=escape(a)}catch(c){console.log(c),b=a}var c="";try{c=decodeURIComponent(b)}catch(a){console.log(a),c=b}return c},qrcode.decode_utf8=function(a){return qrcode.isUrl(a)?qrcode.decode_url(a):a},qrcode.process=function(a){var b=qrcode.imagedata.data,c=0,d=new Uint8ClampedArray(b.buffer,c,qrcode.width*qrcode.height);c+=qrcode.width*qrcode.height;var e=new Uint8ClampedArray(b.buffer,c,qrcode.width*qrcode.height);c+=qrcode.width*qrcode.height;var f=Binarizer.calculateRequiredBufferSize(qrcode.width,qrcode.height),g=new Uint8ClampedArray(b.buffer,c,f);qrcode.grayscale(b,qrcode.width,qrcode.height,d),Binarizer.binarize(d,qrcode.width,qrcode.height,e,g);var h;if(qrcode.debug){h=new ImageData(new Uint8ClampedArray(4*(qrcode.width*qrcode.height)),qrcode.width,qrcode.height);for(var k=0;k<qrcode.height;k++)for(var l=0;l<qrcode.width;l++){var m=4*l+4*(k*qrcode.width),n=e[k*qrcode.width+l]?0:255;h.data[m]=n,h.data[m+1]=n,h.data[m+2]=n,h.data[m+3]=255}a.putImageData(h,0,0)}var o=new Detector(e),p=o.detect();if(qrcode.debug){for(var k=0;k<p.bits.Height;k++)for(var l=0;l<p.bits.Width;l++){var m=2*(4*l)+4*(2*k*qrcode.width),q=p.bits.get_Renamed(l,k);h.data[m]=q?0:255,h.data[m+1]=q?0:255,h.data[m+2]=255}a.putImageData(h,0,0)}for(var r=Decoder.decode(p.bits),s=r.DataByte,t="",u=0;u<s.length;u++)for(var i=0;i<s[u].length;i++)t+=String.fromCharCode(s[u][i]);return qrcode.decode_utf8(t)},qrcode.getMiddleBrightnessPerArea=function(a){for(var b=Math.floor,c=4,d=b(qrcode.width/c),e=b(qrcode.height/c),f=[,,,,],g=0;g<c;g++){f[g]=[,,,,];for(var h=0;h<c;h++)f[g][h]=[0,0]}for(var i=0;i<c;i++)for(var j=0;j<c;j++){f[j][i][0]=255;for(var k=0;k<e;k++)for(var l,m=0;m<d;m++)l=a[d*j+m+(e*i+k)*qrcode.width],l<f[j][i][0]&&(f[j][i][0]=l),l>f[j][i][1]&&(f[j][i][1]=l)}for(var n=[,,,,],o=0;o<c;o++)n[o]=[,,,,];for(var i=0;i<c;i++)for(var j=0;j<c;j++)n[j][i]=b((f[j][i][0]+f[j][i][1])/2);return n},qrcode.grayScaleToBitmap=function(a){for(var b=Math.floor,c=qrcode.getMiddleBrightnessPerArea(a),d=c.length,e=b(qrcode.width/d),f=b(qrcode.height/d),g=new ArrayBuffer(qrcode.width*qrcode.height),h=new Uint8Array(g),i=0;i<d;i++)for(var j=0;j<d;j++)for(var k=0;k<f;k++)for(var l=0;l<e;l++)h[e*j+l+(f*i+k)*qrcode.width]=!!(a[e*j+l+(f*i+k)*qrcode.width]<c[j][i]);return h},qrcode.grayscale=function(a,b,c,d){for(var e=0;e<c;e++)for(var f=0;f<b;f++){var g=e*b+f,h=4*g;d[g]=77*a[h]+150*a[h+1]+29*a[h+2]+128>>8}};function URShift(a,b){return 0<=a?a>>b:(a>>b)+(2<<~b)}window.qrscanner=qrcode;
"use strict";var MIN_SKIP=3,MAX_MODULES=57,INTEGER_MATH_SHIFT=8,CENTER_QUORUM=2;qrcode.orderBestPatterns=function(a){function b(a,b){var c=a.X-b.X,d=a.Y-b.Y;return Math.sqrt(c*c+d*d)}var c,d,e,f=b(a[0],a[1]),g=b(a[1],a[2]),h=b(a[0],a[2]);if(g>=f&&g>=h?(d=a[0],c=a[1],e=a[2]):h>=g&&h>=f?(d=a[1],c=a[0],e=a[2]):(d=a[2],c=a[0],e=a[1]),0>function(a,b,c){var d=b.x,e=b.y;return(c.x-d)*(a.y-e)-(c.y-e)*(a.x-d)}(c,d,e)){var i=c;c=e,e=i}a[0]=c,a[1]=d,a[2]=e};function FinderPattern(a,b,c){var d=Math.abs;this.x=a,this.y=b,this.count=1,this.estimatedModuleSize=c,this.__defineGetter__("EstimatedModuleSize",function(){return this.estimatedModuleSize}),this.__defineGetter__("Count",function(){return this.count}),this.__defineGetter__("X",function(){return this.x}),this.__defineGetter__("Y",function(){return this.y}),this.incrementCount=function(){this.count++},this.aboutEquals=function(a,b,c){if(d(b-this.y)<=a&&d(c-this.x)<=a){var e=d(a-this.estimatedModuleSize);return 1>=e||1>=e/this.estimatedModuleSize}return!1}}function FinderPatternInfo(a){this.bottomLeft=a[0],this.topLeft=a[1],this.topRight=a[2],this.__defineGetter__("BottomLeft",function(){return this.bottomLeft}),this.__defineGetter__("TopLeft",function(){return this.topLeft}),this.__defineGetter__("TopRight",function(){return this.topRight})}function FinderPatternFinder(){var a=Math.floor,b=Math.abs;this.image=null,this.possibleCenters=[],this.hasSkipped=!1,this.crossCheckStateCount=[0,0,0,0,0],this.resultPointCallback=null,this.__defineGetter__("CrossCheckStateCount",function(){return this.crossCheckStateCount[0]=0,this.crossCheckStateCount[1]=0,this.crossCheckStateCount[2]=0,this.crossCheckStateCount[3]=0,this.crossCheckStateCount[4]=0,this.crossCheckStateCount}),this.foundPatternCross=function(c){for(var d,e=0,f=0;5>f;f++){if(d=c[f],0==d)return!1;e+=d}if(7>e)return!1;var g=a((e<<INTEGER_MATH_SHIFT)/7),h=a(g/2);return b(g-(c[0]<<INTEGER_MATH_SHIFT))<h&&b(g-(c[1]<<INTEGER_MATH_SHIFT))<h&&b(3*g-(c[2]<<INTEGER_MATH_SHIFT))<3*h&&b(g-(c[3]<<INTEGER_MATH_SHIFT))<h&&b(g-(c[4]<<INTEGER_MATH_SHIFT))<h},this.centerFromEnd=function(a,b){return b-a[4]-a[3]-a[2]/2},this.crossCheckVertical=function(a,c,d,e){for(var f=this.image,g=qrcode.height,h=this.CrossCheckStateCount,j=a;0<=j&&f[c+j*qrcode.width];)h[2]++,j--;if(0>j)return NaN;for(;0<=j&&!f[c+j*qrcode.width]&&h[1]<=d;)h[1]++,j--;if(0>j||h[1]>d)return NaN;for(;0<=j&&f[c+j*qrcode.width]&&h[0]<=d;)h[0]++,j--;if(h[0]>d)return NaN;for(j=a+1;j<g&&f[c+j*qrcode.width];)h[2]++,j++;if(j==g)return NaN;for(;j<g&&!f[c+j*qrcode.width]&&h[3]<d;)h[3]++,j++;if(j==g||h[3]>=d)return NaN;for(;j<g&&f[c+j*qrcode.width]&&h[4]<d;)h[4]++,j++;if(h[4]>=d)return NaN;var i=h[0]+h[1]+h[2]+h[3]+h[4];return 5*b(i-e)>=2*e?NaN:this.foundPatternCross(h)?this.centerFromEnd(h,j):NaN},this.crossCheckHorizontal=function(a,c,d,e){for(var f=this.image,g=qrcode.width,h=this.CrossCheckStateCount,i=a;0<=i&&f[i+c*qrcode.width];)h[2]++,i--;if(0>i)return NaN;for(;0<=i&&!f[i+c*qrcode.width]&&h[1]<=d;)h[1]++,i--;if(0>i||h[1]>d)return NaN;for(;0<=i&&f[i+c*qrcode.width]&&h[0]<=d;)h[0]++,i--;if(h[0]>d)return NaN;for(i=a+1;i<g&&f[i+c*qrcode.width];)h[2]++,i++;if(i==g)return NaN;for(;i<g&&!f[i+c*qrcode.width]&&h[3]<d;)h[3]++,i++;if(i==g||h[3]>=d)return NaN;for(;i<g&&f[i+c*qrcode.width]&&h[4]<d;)h[4]++,i++;if(h[4]>=d)return NaN;var j=h[0]+h[1]+h[2]+h[3]+h[4];return 5*b(j-e)>=e?NaN:this.foundPatternCross(h)?this.centerFromEnd(h,i):NaN},this.handlePossibleCenter=function(b,c,d){var e=b[0]+b[1]+b[2]+b[3]+b[4],f=this.centerFromEnd(b,d),g=this.crossCheckVertical(c,a(f),b[2],e);if(!isNaN(g)&&(f=this.crossCheckHorizontal(a(f),a(g),b[2],e),!isNaN(f))){for(var h,i=e/7,j=!1,k=this.possibleCenters.length,l=0;l<k;l++)if(h=this.possibleCenters[l],h.aboutEquals(i,g,f)){h.incrementCount(),j=!0;break}if(!j){var m=new FinderPattern(f,g,i);this.possibleCenters.push(m),null!=this.resultPointCallback&&this.resultPointCallback.foundPossibleResultPoint(m)}return!0}return!1},this.selectBestPatterns=function(){var a=this.possibleCenters.length;if(3>a)throw new Error("Couldn't find enough finder patterns (found "+a+")");if(3<a){for(var c,d=0,e=0,f=0;f<a;f++)c=this.possibleCenters[f].EstimatedModuleSize,d+=c,e+=c*c;var g=d/a;this.possibleCenters.sort(function(a,c){var d=b(c.EstimatedModuleSize-g),e=b(a.EstimatedModuleSize-g);return d<e?-1:d==e?0:1});for(var h,i=Math.sqrt(e/a-g*g),j=Math.max(0.2*g,i),f=this.possibleCenters.length-1;0<=f;f--)h=this.possibleCenters[f],b(h.EstimatedModuleSize-g)>j&&this.possibleCenters.splice(f,1)}return 3<this.possibleCenters.length&&this.possibleCenters.sort(function(c,a){return c.count>a.count?-1:c.count<a.count?1:0}),[this.possibleCenters[0],this.possibleCenters[1],this.possibleCenters[2]]},this.findRowSkip=function(){var c=this.possibleCenters.length;if(1>=c)return 0;for(var d,e=null,f=0;f<c;f++)if(d=this.possibleCenters[f],d.Count>=CENTER_QUORUM)if(null==e)e=d;else return this.hasSkipped=!0,a((b(e.X-d.X)-b(e.Y-d.Y))/2);return 0},this.haveMultiplyConfirmedCenters=function(){for(var a,c=0,d=0,e=this.possibleCenters.length,f=0;f<e;f++)a=this.possibleCenters[f],a.Count>=CENTER_QUORUM&&(c++,d+=a.EstimatedModuleSize);if(3>c)return!1;for(var g=d/e,h=0,f=0;f<e;f++)a=this.possibleCenters[f],h+=b(a.EstimatedModuleSize-g);return h<=0.05*d},this.findFinderPattern=function(b){this.image=b;var c=qrcode.height,d=qrcode.width,e=a(3*c/(4*MAX_MODULES));(e<MIN_SKIP||!1)&&(e=MIN_SKIP);for(var f=!1,g=[,,,,,],h=e-1;h<c&&!f;h+=e){g[0]=0,g[1]=0,g[2]=0,g[3]=0,g[4]=0;for(var i=0,k=0;k<d;k++)if(b[k+h*qrcode.width])1==(1&i)&&i++,g[i]++;else if(0!=(1&i))g[i]++;else if(4!=i)g[++i]++;else if(this.foundPatternCross(g)){var j=this.handlePossibleCenter(g,h,k);if(!j){do k++;while(k<d&&!b[k+h*qrcode.width]);k--}else if(e=2,this.hasSkipped)f=this.haveMultiplyConfirmedCenters();else{var l=this.findRowSkip();l>g[2]&&(h+=l-g[2]-e,k=d-1)}i=0,g[0]=0,g[1]=0,g[2]=0,g[3]=0,g[4]=0}else g[0]=g[2],g[1]=g[3],g[2]=g[4],g[3]=1,g[4]=0,i=3;if(this.foundPatternCross(g)){var j=this.handlePossibleCenter(g,h,d);j&&(e=g[0],this.hasSkipped&&(f=this.haveMultiplyConfirmedCenters()))}}var m=this.selectBestPatterns();return qrcode.orderBestPatterns(m),new FinderPatternInfo(m)}}
"use strict";function AlignmentPattern(a,b,c){var d=Math.abs,e=Math.floor;this.x=a,this.y=b,this.count=1,this.estimatedModuleSize=c,this.__defineGetter__("EstimatedModuleSize",function(){return this.estimatedModuleSize}),this.__defineGetter__("Count",function(){return this.count}),this.__defineGetter__("X",function(){return e(this.x)}),this.__defineGetter__("Y",function(){return e(this.y)}),this.incrementCount=function(){this.count++},this.aboutEquals=function(a,b,c){if(d(b-this.y)<=a&&d(c-this.x)<=a){var e=d(a-this.estimatedModuleSize);return 1>=e||1>=e/this.estimatedModuleSize}return!1}}function AlignmentPatternFinder(a,b,c,d,e,f,g){var h=Math.abs;this.image=a,this.possibleCenters=[],this.startX=b,this.startY=c,this.width=d,this.height=e,this.moduleSize=f,this.crossCheckStateCount=[0,0,0],this.resultPointCallback=g,this.centerFromEnd=function(a,b){return b-a[2]-a[1]/2},this.foundPatternCross=function(a){for(var b=this.moduleSize,c=0;3>c;c++)if(h(b-a[c])>=b/2)return!1;return!0},this.crossCheckVertical=function(a,b,c,d){var e=this.image,f=qrcode.height,g=this.crossCheckStateCount;g[0]=0,g[1]=0,g[2]=0;for(var j=a;0<=j&&e[b+j*qrcode.width]&&g[1]<=c;)g[1]++,j--;if(0>j||g[1]>c)return NaN;for(;0<=j&&!e[b+j*qrcode.width]&&g[0]<=c;)g[0]++,j--;if(g[0]>c)return NaN;for(j=a+1;j<f&&e[b+j*qrcode.width]&&g[1]<=c;)g[1]++,j++;if(j==f||g[1]>c)return NaN;for(;j<f&&!e[b+j*qrcode.width]&&g[2]<=c;)g[2]++,j++;if(g[2]>c)return NaN;var i=g[0]+g[1]+g[2];return 5*h(i-d)>=2*d?NaN:this.foundPatternCross(g)?this.centerFromEnd(g,j):NaN},this.handlePossibleCenter=function(a,b,c){var d=a[0]+a[1]+a[2],e=this.centerFromEnd(a,c),f=this.crossCheckVertical(b,Math.floor(e),2*a[1],d);if(!isNaN(f)){for(var g,h=(a[0]+a[1]+a[2])/3,i=this.possibleCenters.length,j=0;j<i;j++)if(g=this.possibleCenters[j],g.aboutEquals(h,f,e))return new AlignmentPattern(e,f,h);var k=new AlignmentPattern(e,f,h);this.possibleCenters.push(k),null!=this.resultPointCallback&&this.resultPointCallback.foundPossibleResultPoint(k)}return null},this.find=function(){for(var b,e=this.startX,f=this.height,g=e+d,h=[0,0,0],i=0;i<f;i++){b=c+(f>>1)+(0==(1&i)?i+1>>1:-(i+1>>1)),h[0]=0,h[1]=0,h[2]=0;for(var k=e;k<g&&!a[k+qrcode.width*b];)k++;for(var j=0;k<g;){if(!a[k+b*qrcode.width])1==j&&j++,h[j]++;else if(1==j)h[j]++;else if(2==j){if(this.foundPatternCross(h)){var l=this.handlePossibleCenter(h,b,k);if(null!=l)return l}h[0]=h[2],h[1]=1,h[2]=0,j=1}else h[++j]++;k++}if(this.foundPatternCross(h)){var l=this.handlePossibleCenter(h,b,g);if(null!=l)return l}}if(0!=this.possibleCenters.length)return this.possibleCenters[0];throw"Couldn't find enough alignment patterns"}}
'use strict';function QRCodeDataBlockReader(a,b,c){this.blockPointer=0,this.bitPointer=7,this.dataLength=0,this.blocks=a,this.numErrorCorrectionCode=c,9>=b?this.dataLengthMode=0:10<=b&&26>=b?this.dataLengthMode=1:27<=b&&40>=b&&(this.dataLengthMode=2),this.getNextBits=function(a){var b=0;if(a<this.bitPointer+1){for(var c=0,d=0;d<a;d++)c+=1<<d;return c<<=this.bitPointer-a+1,b=(this.blocks[this.blockPointer]&c)>>this.bitPointer-a+1,this.bitPointer-=a,b}if(a<this.bitPointer+1+8){for(var e=0,d=0;d<this.bitPointer+1;d++)e+=1<<d;return b=(this.blocks[this.blockPointer]&e)<<a-(this.bitPointer+1),this.blockPointer++,b+=this.blocks[this.blockPointer]>>8-(a-(this.bitPointer+1)),this.bitPointer-=a%8,0>this.bitPointer&&(this.bitPointer=8+this.bitPointer),b}if(a<this.bitPointer+1+16){for(var e=0,f=0,d=0;d<this.bitPointer+1;d++)e+=1<<d;var g=(this.blocks[this.blockPointer]&e)<<a-(this.bitPointer+1);this.blockPointer++;var h=this.blocks[this.blockPointer]<<a-(this.bitPointer+1+8);this.blockPointer++;for(var d=0;d<a-(this.bitPointer+1+8);d++)f+=1<<d;f<<=8-(a-(this.bitPointer+1+8));var i=(this.blocks[this.blockPointer]&f)>>8-(a-(this.bitPointer+1+8));return b=g+h+i,this.bitPointer-=(a-8)%8,0>this.bitPointer&&(this.bitPointer=8+this.bitPointer),b}return 0},this.NextMode=function(){return this.blockPointer>this.blocks.length-this.numErrorCorrectionCode-2?0:this.getNextBits(4)},this.getDataLength=function(a){for(var b=0;!0&&!(1==a>>b);)b++;return this.getNextBits(qrcode.sizeOfDataLengthInfo[this.dataLengthMode][b])},this.getRomanAndFigureString=function(a){var b=a,c=0,d='',e=['0','1','2','3','4','5','6','7','8','9','A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z',' ','$','%','*','+','-','.','/',':'];do if(1<b){c=this.getNextBits(11);var f=Math.floor(c/45),g=c%45;d+=e[f],d+=e[g],b-=2}else 1==b&&(c=this.getNextBits(6),d+=e[c],b-=1);while(0<b);return d},this.getFigureString=function(a){var b=a,c=0,d='';do 3<=b?(c=this.getNextBits(10),100>c&&(d+='0'),10>c&&(d+='0'),b-=3):2==b?(c=this.getNextBits(7),10>c&&(d+='0'),b-=2):1==b&&(c=this.getNextBits(4),b-=1),d+=c;while(0<b);return d},this.get8bitByteArray=function(a){var b=a,c=0,d=[];do c=this.getNextBits(8),d.push(c),b--;while(0<b);return d},this.getKanjiString=function(a){var b=a,c=0,d='';do{c=this.getNextBits(13);var e=c%192,f=c/192,g=(f<<8)+e,h=0;h=40956>=g+33088?g+33088:g+49472,d+=String.fromCharCode(h),b--}while(0<b);return d},this.parseECIValue=function(){var a=0,b=this.getNextBits(8);if(0==(128&b)&&(a=127&b),128==(192&b)){var c=this.getNextBits(8);a=(63&b)<<8|c}if(192==(224&b)){var d=this.getNextBits(8);a=(31&b)<<16|d}return a},this.__defineGetter__('DataByte',function(){var a=[],b=1,c=2,d=4,e=7,f=8;do{var g=this.NextMode();if(0==g)if(0<a.length)break;else throw'Empty data block';if(g!=b&&g!=c&&g!=d&&g!=f&&g!=e)throw'Invalid mode: '+g+' in (block:'+this.blockPointer+' bit:'+this.bitPointer+')';if(g==e)var h=this.parseECIValue();else{var i=this.getDataLength(g);if(1>i)throw'Invalid data length: '+i;switch(g){case b:for(var k=this.getFigureString(i),l=Array(k.length),m=0;m<k.length;m++)l[m]=k.charCodeAt(m);a.push(l);break;case c:for(var k=this.getRomanAndFigureString(i),l=Array(k.length),m=0;m<k.length;m++)l[m]=k.charCodeAt(m);a.push(l);break;case d:var h=this.get8bitByteArray(i);a.push(h);break;case f:var k=this.getKanjiString(i);a.push(k);}}}while(!0);return a})}

//# sourceMappingURL=jsqrcode.min.js.map