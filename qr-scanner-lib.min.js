!function(){"use strict";function e(e,t){this.count=e,this.dataCodewords=t,this.__defineGetter__("Count",function(){return this.count}),this.__defineGetter__("DataCodewords",function(){return this.dataCodewords})}function t(e,t,r){this.ecCodewordsPerBlock=e,this.ecBlocks=r?new Array(t,r):new Array(t),this.__defineGetter__("ECCodewordsPerBlock",function(){return this.ecCodewordsPerBlock}),this.__defineGetter__("TotalECCodewords",function(){return this.ecCodewordsPerBlock*this.NumBlocks}),this.__defineGetter__("NumBlocks",function(){for(var e=0,t=0;t<this.ecBlocks.length;t++)e+=this.ecBlocks[t].length;return e}),this.getECBlocks=function(){return this.ecBlocks}}function r(e,t,r,n,i,o){this.versionNumber=e,this.alignmentPatternCenters=t,this.ecBlocks=new Array(r,n,i,o);for(var a=0,h=r.ECCodewordsPerBlock,w=r.getECBlocks(),f=0;f<w.length;f++){var u=w[f];a+=u.Count*(u.DataCodewords+h)}this.totalCodewords=a,this.__defineGetter__("VersionNumber",function(){return this.versionNumber}),this.__defineGetter__("AlignmentPatternCenters",function(){return this.alignmentPatternCenters}),this.__defineGetter__("TotalCodewords",function(){return this.totalCodewords}),this.__defineGetter__("DimensionForVersion",function(){return 17+4*this.versionNumber}),this.buildFunctionPattern=function(){var e=this.DimensionForVersion,t=new s(e);t.setRegion(0,0,9,9),t.setRegion(e-8,0,8,9),t.setRegion(0,e-8,9,8);for(var r=this.alignmentPatternCenters.length,n=0;n<r;n++)for(var i=this.alignmentPatternCenters[n]-2,o=0;o<r;o++)0==n&&(0==o||o==r-1)||n==r-1&&0==o||t.setRegion(this.alignmentPatternCenters[o]-2,i,5,5);return t.setRegion(6,9,1,e-17),t.setRegion(9,6,e-17,1),this.versionNumber>6&&(t.setRegion(e-11,0,3,6),t.setRegion(0,e-11,6,3)),t},this.getECBlocksForLevel=function(e){return this.ecBlocks[e.ordinal()]}}function n(e,t,r,i,o,a,s,h,w){this.a11=e,this.a12=i,this.a13=s,this.a21=t,this.a22=o,this.a23=h,this.a31=r,this.a32=a,this.a33=w,this.transformPoints1=function(e){for(var t=e.length,r=this.a11,n=this.a12,i=this.a13,o=this.a21,a=this.a22,s=this.a23,h=this.a31,w=this.a32,f=this.a33,u=0;u<t;u+=2){var l=e[u],c=e[u+1],d=i*l+s*c+f;e[u]=(r*l+o*c+h)/d,e[u+1]=(n*l+a*c+w)/d}},this.transformPoints2=function(e,t){for(var r=e.length,n=0;n<r;n++){var i=e[n],o=t[n],a=this.a13*i+this.a23*o+this.a33;e[n]=(this.a11*i+this.a21*o+this.a31)/a,t[n]=(this.a12*i+this.a22*o+this.a32)/a}},this.buildAdjoint=function(){return new n(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)},this.times=function(e){return new n(this.a11*e.a11+this.a21*e.a12+this.a31*e.a13,this.a11*e.a21+this.a21*e.a22+this.a31*e.a23,this.a11*e.a31+this.a21*e.a32+this.a31*e.a33,this.a12*e.a11+this.a22*e.a12+this.a32*e.a13,this.a12*e.a21+this.a22*e.a22+this.a32*e.a23,this.a12*e.a31+this.a22*e.a32+this.a32*e.a33,this.a13*e.a11+this.a23*e.a12+this.a33*e.a13,this.a13*e.a21+this.a23*e.a22+this.a33*e.a23,this.a13*e.a31+this.a23*e.a32+this.a33*e.a33)}}function i(e){this.image=e,this.resultPointCallback=null,this.sizeOfBlackWhiteBlackRun=function(e,t,r,n){var i=Math.abs(n-t)>Math.abs(r-e);if(i){var o=e;e=t,t=o,o=r,r=n,n=o}for(var a=Math.abs(r-e),s=Math.abs(n-t),h=-a>>1,w=t<n?1:-1,f=e<r?1:-1,u=0,l=e,c=t;l!=r;l+=f){var d=i?c:l,v=i?l:c;if(1==u?this.image[d+v*k.width]&&u++:this.image[d+v*k.width]||u++,3==u){var g=l-e,m=c-t;return Math.sqrt(g*g+m*m)}if((h+=s)>0){if(c==n)break;c+=w,h-=a}}var b=r-e,y=n-t;return Math.sqrt(b*b+y*y)},this.sizeOfBlackWhiteBlackRunBothWays=function(e,t,r,n){var i=this.sizeOfBlackWhiteBlackRun(e,t,r,n),o=1,a=e-(r-e);a<0?(o=e/(e-a),a=0):a>=k.width&&(o=(k.width-1-e)/(a-e),a=k.width-1);var s=Math.floor(t-(n-t)*o);return o=1,s<0?(o=t/(t-s),s=0):s>=k.height&&(o=(k.height-1-t)/(s-t),s=k.height-1),a=Math.floor(e+(a-e)*o),(i+=this.sizeOfBlackWhiteBlackRun(e,t,a,s))-1},this.calculateModuleSizeOneWay=function(e,t){var r=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(e.X),Math.floor(e.Y),Math.floor(t.X),Math.floor(t.Y)),n=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(t.X),Math.floor(t.Y),Math.floor(e.X),Math.floor(e.Y));return isNaN(r)?n/7:isNaN(n)?r/7:(r+n)/14},this.calculateModuleSize=function(e,t,r){return(this.calculateModuleSizeOneWay(e,t)+this.calculateModuleSizeOneWay(e,r))/2},this.distance=function(e,t){var r=e.X-t.X,n=e.Y-t.Y;return Math.sqrt(r*r+n*n)},this.computeDimension=function(e,t,r,n){var i=7+(Math.round(this.distance(e,t)/n)+Math.round(this.distance(e,r)/n)>>1);switch(3&i){case 0:i++;break;case 2:i--;break;case 3:throw new Error("QR Error: in detector")}return i},this.findAlignmentInRegion=function(e,t,r,n){var i=Math.floor(n*e),o=Math.max(0,t-i),a=Math.min(k.width-1,t+i);if(a-o<3*e)throw new Error("QR Error: in detector");var s=Math.max(0,r-i),h=Math.min(k.height-1,r+i);return new function(e,t,r,n,i,o,a){this.image=e,this.possibleCenters=new Array,this.startX=t,this.startY=r,this.width=n,this.height=i,this.moduleSize=o,this.crossCheckStateCount=new Array(0,0,0),this.resultPointCallback=a,this.centerFromEnd=function(e,t){return t-e[2]-e[1]/2},this.foundPatternCross=function(e){for(var t=this.moduleSize,r=t/2,n=0;n<3;n++)if(Math.abs(t-e[n])>=r)return!1;return!0},this.crossCheckVertical=function(e,t,r,n){var i=this.image,o=k.height,a=this.crossCheckStateCount;a[0]=0,a[1]=0,a[2]=0;for(var s=e;s>=0&&i[t+s*k.width]&&a[1]<=r;)a[1]++,s--;if(s<0||a[1]>r)return NaN;for(;s>=0&&!i[t+s*k.width]&&a[0]<=r;)a[0]++,s--;if(a[0]>r)return NaN;for(s=e+1;s<o&&i[t+s*k.width]&&a[1]<=r;)a[1]++,s++;if(s==o||a[1]>r)return NaN;for(;s<o&&!i[t+s*k.width]&&a[2]<=r;)a[2]++,s++;if(a[2]>r)return NaN;var h=a[0]+a[1]+a[2];return 5*Math.abs(h-n)>=2*n?NaN:this.foundPatternCross(a)?this.centerFromEnd(a,s):NaN},this.handlePossibleCenter=function(e,t,r){var n=e[0]+e[1]+e[2],i=this.centerFromEnd(e,r),o=this.crossCheckVertical(t,Math.floor(i),2*e[1],n);if(!isNaN(o)){for(var a=(e[0]+e[1]+e[2])/3,s=this.possibleCenters.length,h=0;h<s;h++){if(this.possibleCenters[h].aboutEquals(a,o,i))return new l(i,o,a)}var w=new l(i,o,a);this.possibleCenters.push(w),null!=this.resultPointCallback&&this.resultPointCallback.foundPossibleResultPoint(w)}return null},this.find=function(){for(var t=this.startX,i=this.height,o=t+n,a=r+(i>>1),s=new Array(0,0,0),h=0;h<i;h++){var w=a+(0==(1&h)?h+1>>1:-(h+1>>1));s[0]=0,s[1]=0,s[2]=0;for(var f=t;f<o&&!e[f+k.width*w];)f++;for(var u=0;f<o;){if(e[f+w*k.width])if(1==u)s[u]++;else if(2==u){if(this.foundPatternCross(s)){if(null!=(l=this.handlePossibleCenter(s,w,f)))return l}s[0]=s[2],s[1]=1,s[2]=0,u=1}else s[++u]++;else 1==u&&u++,s[u]++;f++}if(this.foundPatternCross(s)){var l=this.handlePossibleCenter(s,w,o);if(null!=l)return l}}if(0!=this.possibleCenters.length)return this.possibleCenters[0];throw new Error("QR Error: Couldn't find enough alignment patterns")}}(this.image,o,s,a-o,h-s,e,this.resultPointCallback).find()},this.createTransform=function(e,t,r,i,o){var a,s,h,w,f=o-3.5;null!=i?(a=i.X,s=i.Y,h=w=f-3):(a=t.X-e.X+r.X,s=t.Y-e.Y+r.Y,h=w=f);return n.quadrilateralToQuadrilateral(3.5,3.5,f,3.5,h,w,3.5,f,e.X,e.Y,t.X,t.Y,a,s,r.X,r.Y)},this.sampleGrid=function(e,t,r){return g.sampleGrid3(e,r,t)},this.processFinderPatternInfo=function(e){var t=e.TopLeft,n=e.TopRight,i=e.BottomLeft,o=this.calculateModuleSize(t,n,i);if(o<1)throw new Error("QR Error: in detector");var a=this.computeDimension(t,n,i,o),s=r.getProvisionalVersionForDimension(a),h=s.DimensionForVersion-7,w=null;if(s.AlignmentPatternCenters.length>0)for(var f=n.X-t.X+i.X,u=n.Y-t.Y+i.Y,l=1-3/h,c=Math.floor(t.X+l*(f-t.X)),d=Math.floor(t.Y+l*(u-t.Y)),v=4;v<=16;v<<=1){w=this.findAlignmentInRegion(o,c,d,v);break}var g,m=this.createTransform(t,n,i,w,a),b=this.sampleGrid(this.image,m,a);return g=null==w?new Array(i,t,n):new Array(i,t,n,w),new function(e,t){this.bits=e,this.points=t}(b,g)},this.detect=function(){var e=(new function(){this.image=null,this.possibleCenters=[],this.hasSkipped=!1,this.crossCheckStateCount=new Array(0,0,0,0,0),this.resultPointCallback=null,this.__defineGetter__("CrossCheckStateCount",function(){return this.crossCheckStateCount[0]=0,this.crossCheckStateCount[1]=0,this.crossCheckStateCount[2]=0,this.crossCheckStateCount[3]=0,this.crossCheckStateCount[4]=0,this.crossCheckStateCount}),this.foundPatternCross=function(e){for(var t=0,r=0;r<5;r++){var n=e[r];if(0==n)return!1;t+=n}if(t<7)return!1;var i=Math.floor((t<<S)/7),o=Math.floor(i/2);return Math.abs(i-(e[0]<<S))<o&&Math.abs(i-(e[1]<<S))<o&&Math.abs(3*i-(e[2]<<S))<3*o&&Math.abs(i-(e[3]<<S))<o&&Math.abs(i-(e[4]<<S))<o},this.centerFromEnd=function(e,t){return t-e[4]-e[3]-e[2]/2},this.crossCheckVertical=function(e,t,r,n){for(var i=this.image,o=k.height,a=this.CrossCheckStateCount,s=e;s>=0&&i[t+s*k.width];)a[2]++,s--;if(s<0)return NaN;for(;s>=0&&!i[t+s*k.width]&&a[1]<=r;)a[1]++,s--;if(s<0||a[1]>r)return NaN;for(;s>=0&&i[t+s*k.width]&&a[0]<=r;)a[0]++,s--;if(a[0]>r)return NaN;for(s=e+1;s<o&&i[t+s*k.width];)a[2]++,s++;if(s==o)return NaN;for(;s<o&&!i[t+s*k.width]&&a[3]<r;)a[3]++,s++;if(s==o||a[3]>=r)return NaN;for(;s<o&&i[t+s*k.width]&&a[4]<r;)a[4]++,s++;if(a[4]>=r)return NaN;var h=a[0]+a[1]+a[2]+a[3]+a[4];return 5*Math.abs(h-n)>=2*n?NaN:this.foundPatternCross(a)?this.centerFromEnd(a,s):NaN},this.crossCheckHorizontal=function(e,t,r,n){for(var i=this.image,o=k.width,a=this.CrossCheckStateCount,s=e;s>=0&&i[s+t*k.width];)a[2]++,s--;if(s<0)return NaN;for(;s>=0&&!i[s+t*k.width]&&a[1]<=r;)a[1]++,s--;if(s<0||a[1]>r)return NaN;for(;s>=0&&i[s+t*k.width]&&a[0]<=r;)a[0]++,s--;if(a[0]>r)return NaN;for(s=e+1;s<o&&i[s+t*k.width];)a[2]++,s++;if(s==o)return NaN;for(;s<o&&!i[s+t*k.width]&&a[3]<r;)a[3]++,s++;if(s==o||a[3]>=r)return NaN;for(;s<o&&i[s+t*k.width]&&a[4]<r;)a[4]++,s++;if(a[4]>=r)return NaN;var h=a[0]+a[1]+a[2]+a[3]+a[4];return 5*Math.abs(h-n)>=n?NaN:this.foundPatternCross(a)?this.centerFromEnd(a,s):NaN},this.handlePossibleCenter=function(e,t,r){var n=e[0]+e[1]+e[2]+e[3]+e[4],i=this.centerFromEnd(e,r),o=this.crossCheckVertical(t,Math.floor(i),e[2],n);if(!isNaN(o)&&(i=this.crossCheckHorizontal(Math.floor(i),Math.floor(o),e[2],n),!isNaN(i))){for(var a=n/7,s=!1,h=this.possibleCenters.length,w=0;w<h;w++){var f=this.possibleCenters[w];if(f.aboutEquals(a,o,i)){f.incrementCount(),s=!0;break}}if(!s){var u=new function(e,t,r){this.x=e,this.y=t,this.count=1,this.estimatedModuleSize=r,this.__defineGetter__("EstimatedModuleSize",function(){return this.estimatedModuleSize}),this.__defineGetter__("Count",function(){return this.count}),this.__defineGetter__("X",function(){return this.x}),this.__defineGetter__("Y",function(){return this.y}),this.incrementCount=function(){this.count++},this.aboutEquals=function(e,t,r){if(Math.abs(t-this.y)<=e&&Math.abs(r-this.x)<=e){var n=Math.abs(e-this.estimatedModuleSize);return n<=1||n/this.estimatedModuleSize<=1}return!1}}(i,o,a);this.possibleCenters.push(u),null!=this.resultPointCallback&&this.resultPointCallback.foundPossibleResultPoint(u)}return!0}return!1},this.selectBestPatterns=function(){var e=this.possibleCenters.length;if(e<3)throw new Error("QR Error: Couldn't find enough finder patterns (found "+e+")");if(e>3){for(var t=0,r=0,n=0;n<e;n++){var i=this.possibleCenters[n].EstimatedModuleSize;t+=i,r+=i*i}var o=t/e;this.possibleCenters.sort(function(e,t){var r=Math.abs(t.EstimatedModuleSize-o),n=Math.abs(e.EstimatedModuleSize-o);return r<n?-1:r==n?0:1});for(var a=Math.sqrt(r/e-o*o),s=Math.max(.2*o,a),n=this.possibleCenters.length-1;n>=0;n--){var h=this.possibleCenters[n];Math.abs(h.EstimatedModuleSize-o)>s&&this.possibleCenters.splice(n,1)}}return this.possibleCenters.length>3&&this.possibleCenters.sort(function(e,t){return e.count>t.count?-1:e.count<t.count?1:0}),new Array(this.possibleCenters[0],this.possibleCenters[1],this.possibleCenters[2])},this.findRowSkip=function(){var e=this.possibleCenters.length;if(e<=1)return 0;for(var t=null,r=0;r<e;r++){var n=this.possibleCenters[r];if(n.Count>=P){if(null!=t)return this.hasSkipped=!0,Math.floor((Math.abs(t.X-n.X)-Math.abs(t.Y-n.Y))/2);t=n}}return 0},this.haveMultiplyConfirmedCenters=function(){for(var e=0,t=0,r=this.possibleCenters.length,n=0;n<r;n++){var i=this.possibleCenters[n];i.Count>=P&&(e++,t+=i.EstimatedModuleSize)}if(e<3)return!1;for(var o=t/r,a=0,n=0;n<r;n++)i=this.possibleCenters[n],a+=Math.abs(i.EstimatedModuleSize-o);return a<=.05*t},this.findFinderPattern=function(e){this.image=e;var t=k.height,r=k.width,n=Math.floor(3*t/(4*N));n<B&&(n=B);for(var i=!1,o=new Array(5),a=n-1;a<t&&!i;a+=n){o[0]=0,o[1]=0,o[2]=0,o[3]=0,o[4]=0;for(var s=0,h=0;h<r;h++)if(e[h+a*k.width])1==(1&s)&&s++,o[s]++;else if(0==(1&s))if(4==s)if(this.foundPatternCross(o)){if(f=this.handlePossibleCenter(o,a,h))if(n=2,this.hasSkipped)i=this.haveMultiplyConfirmedCenters();else{var w=this.findRowSkip();w>o[2]&&(a+=w-o[2]-n,h=r-1)}else{do{h++}while(h<r&&!e[h+a*k.width]);h--}s=0,o[0]=0,o[1]=0,o[2]=0,o[3]=0,o[4]=0}else o[0]=o[2],o[1]=o[3],o[2]=o[4],o[3]=1,o[4]=0,s=3;else o[++s]++;else o[s]++;if(this.foundPatternCross(o)){var f=this.handlePossibleCenter(o,a,r);f&&(n=o[0],this.hasSkipped&&(i=this.haveMultiplyConfirmedCenters()))}}var u=this.selectBestPatterns();return k.orderBestPatterns(u),new function(e){this.bottomLeft=e[0],this.topLeft=e[1],this.topRight=e[2],this.__defineGetter__("BottomLeft",function(){return this.bottomLeft}),this.__defineGetter__("TopLeft",function(){return this.topLeft}),this.__defineGetter__("TopRight",function(){return this.topRight})}(u)}}).findFinderPattern(this.image);return this.processFinderPatternInfo(e)}}function o(e){this.errorCorrectionLevel=a.forBits(e>>3&3),this.dataMask=7&e,this.__defineGetter__("ErrorCorrectionLevel",function(){return this.errorCorrectionLevel}),this.__defineGetter__("DataMask",function(){return this.dataMask}),this.GetHashCode=function(){return this.errorCorrectionLevel.ordinal()<<3|this.dataMask},this.Equals=function(e){var t=e;return this.errorCorrectionLevel==t.errorCorrectionLevel&&this.dataMask==t.dataMask}}function a(e,t,r){this.ordinal_Renamed_Field=e,this.bits=t,this.name=r,this.__defineGetter__("Bits",function(){return this.bits}),this.__defineGetter__("Name",function(){return this.name}),this.ordinal=function(){return this.ordinal_Renamed_Field}}function s(e,t){if(t||(t=e),e<1||t<1)throw new Error("QR Error: Both dimensions must be greater than 0");this.width=e,this.height=t;var r=e>>5;0!=(31&e)&&r++,this.rowSize=r,this.bits=new Array(r*t);for(var n=0;n<this.bits.length;n++)this.bits[n]=0;this.__defineGetter__("Width",function(){return this.width}),this.__defineGetter__("Height",function(){return this.height}),this.__defineGetter__("Dimension",function(){if(this.width!=this.height)throw new Error("QR Error: Can't call getDimension() on a non-square matrix");return this.width}),this.get_Renamed=function(e,t){var r=t*this.rowSize+(e>>5);return 0!=(1&u(this.bits[r],31&e))},this.set_Renamed=function(e,t){var r=t*this.rowSize+(e>>5);this.bits[r]|=1<<(31&e)},this.flip=function(e,t){var r=t*this.rowSize+(e>>5);this.bits[r]^=1<<(31&e)},this.clear=function(){for(var e=this.bits.length,t=0;t<e;t++)this.bits[t]=0},this.setRegion=function(e,t,r,n){if(t<0||e<0)throw new Error("QR Error: Left and top must be nonnegative");if(n<1||r<1)throw new Error("QR Error: Height and width must be at least 1");var i=e+r,o=t+n;if(o>this.height||i>this.width)throw new Error("QR Error: The region must fit inside the matrix");for(var a=t;a<o;a++)for(var s=a*this.rowSize,h=e;h<i;h++)this.bits[s+(h>>5)]|=1<<(31&h)}}function h(e,t){this.numDataCodewords=e,this.codewords=t,this.__defineGetter__("NumDataCodewords",function(){return this.numDataCodewords}),this.__defineGetter__("Codewords",function(){return this.codewords})}function w(e,t){if(null==t||0==t.length)throw new Error("QR Error: System.ArgumentException");this.field=e;var r=t.length;if(r>1&&0==t[0]){for(var n=1;n<r&&0==t[n];)n++;if(n==r)this.coefficients=e.Zero.coefficients;else{this.coefficients=new Array(r-n);for(var i=0;i<this.coefficients.length;i++)this.coefficients[i]=0;for(var o=0;o<this.coefficients.length;o++)this.coefficients[o]=t[n+o]}}else this.coefficients=t;this.__defineGetter__("Zero",function(){return 0==this.coefficients[0]}),this.__defineGetter__("Degree",function(){return this.coefficients.length-1}),this.__defineGetter__("Coefficients",function(){return this.coefficients}),this.getCoefficient=function(e){return this.coefficients[this.coefficients.length-1-e]},this.evaluateAt=function(e){if(0==e)return this.getCoefficient(0);var t=this.coefficients.length;if(1==e){for(var r=0,n=0;n<t;n++)r=f.addOrSubtract(r,this.coefficients[n]);return r}for(var i=this.coefficients[0],n=1;n<t;n++)i=f.addOrSubtract(this.field.multiply(e,i),this.coefficients[n]);return i},this.addOrSubtract=function(t){if(this.field!=t.field)throw new Error("QR Error: GF256Polys do not have same GF256 field");if(this.Zero)return t;if(t.Zero)return this;var r=this.coefficients,n=t.coefficients;if(r.length>n.length){var i=r;r=n,n=i}for(var o=new Array(n.length),a=n.length-r.length,s=0;s<a;s++)o[s]=n[s];for(var h=a;h<n.length;h++)o[h]=f.addOrSubtract(r[h-a],n[h]);return new w(e,o)},this.multiply1=function(e){if(this.field!=e.field)throw new Error("QR Error: GF256Polys do not have same GF256 field");if(this.Zero||e.Zero)return this.field.Zero;for(var t=this.coefficients,r=t.length,n=e.coefficients,i=n.length,o=new Array(r+i-1),a=0;a<r;a++)for(var s=t[a],h=0;h<i;h++)o[a+h]=f.addOrSubtract(o[a+h],this.field.multiply(s,n[h]));return new w(this.field,o)},this.multiply2=function(e){if(0==e)return this.field.Zero;if(1==e)return this;for(var t=this.coefficients.length,r=new Array(t),n=0;n<t;n++)r[n]=this.field.multiply(this.coefficients[n],e);return new w(this.field,r)},this.multiplyByMonomial=function(e,t){if(e<0)throw new Error("QR Error: System.ArgumentException");if(0==t)return this.field.Zero;for(var r=this.coefficients.length,n=new Array(r+e),i=0;i<n.length;i++)n[i]=0;for(i=0;i<r;i++)n[i]=this.field.multiply(this.coefficients[i],t);return new w(this.field,n)},this.divide=function(e){if(this.field!=e.field)throw new Error("QR Error: GF256Polys do not have same GF256 field");if(e.Zero)throw new Error("QR Error: Divide by 0");for(var t=this.field.Zero,r=this,n=e.getCoefficient(e.Degree),i=this.field.inverse(n);r.Degree>=e.Degree&&!r.Zero;){var o=r.Degree-e.Degree,a=this.field.multiply(r.getCoefficient(r.Degree),i),s=e.multiplyByMonomial(o,a),h=this.field.buildMonomial(o,a);t=t.addOrSubtract(h),r=r.addOrSubtract(s)}return new Array(t,r)}}function f(e){this.expTable=new Array(256),this.logTable=new Array(256);for(var t=1,r=0;r<256;r++)this.expTable[r]=t,(t<<=1)>=256&&(t^=e);for(r=0;r<255;r++)this.logTable[this.expTable[r]]=r;var n=new Array(1);n[0]=0,this.zero=new w(this,new Array(n));var i=new Array(1);i[0]=1,this.one=new w(this,new Array(i)),this.__defineGetter__("Zero",function(){return this.zero}),this.__defineGetter__("One",function(){return this.one}),this.buildMonomial=function(e,t){if(e<0)throw new Error("QR Error: System.ArgumentException");if(0==t)return this.zero;for(var r=new Array(e+1),n=0;n<r.length;n++)r[n]=0;return r[0]=t,new w(this,r)},this.exp=function(e){return this.expTable[e]},this.log=function(e){if(0==e)throw new Error("QR Error: System.ArgumentException");return this.logTable[e]},this.inverse=function(e){if(0==e)throw new Error("QR Error: System.ArithmeticException");return this.expTable[255-this.logTable[e]]},this.multiply=function(e,t){return 0==e||0==t?0:1==e?t:1==t?e:this.expTable[(this.logTable[e]+this.logTable[t])%255]}}function u(e,t){return e>=0?e>>t:(e>>t)+(2<<~t)}function l(e,t,r){this.x=e,this.y=t,this.count=1,this.estimatedModuleSize=r,this.__defineGetter__("EstimatedModuleSize",function(){return this.estimatedModuleSize}),this.__defineGetter__("Count",function(){return this.count}),this.__defineGetter__("X",function(){return Math.floor(this.x)}),this.__defineGetter__("Y",function(){return Math.floor(this.y)}),this.incrementCount=function(){this.count++},this.aboutEquals=function(e,t,r){if(Math.abs(t-this.y)<=e&&Math.abs(r-this.x)<=e){var n=Math.abs(e-this.estimatedModuleSize);return n<=1||n/this.estimatedModuleSize<=1}return!1}}var c=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),d=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),v=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return d(e,null,[{key:"calculateRequiredBufferSize",value:function(t,r){var n=e._calculateBlockSize(t,r),i=c(n,3);return i[1]*i[2]}},{key:"_calculateBlockSize",value:function(t,r){var n=Math.max(Math.floor(Math.min(t,r)/e.TARGET_BLOCK_COUNT_ALONG_SHORTER_SIDE),e.MIN_BLOCK_SIZE);return[n,Math.ceil(t/n),Math.ceil(r/n)]}},{key:"binarize",value:function(t,r,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=e._calculateBlockSize(r,n),s=c(a,3),h=s[0],w=s[1],f=s[2],u=void 0;if(o){if(!(o instanceof Uint8ClampedArray)||o.byteLength!==w*f)throw new Error("QR Error: Illegal Buffer.");u=o}else u=new Uint8ClampedArray(w*f);for(var l=0;l<f;++l)for(var d=0;d<w;++d){var v=e._calculateBlockThreshold(t,r,n,d,l,w,h,u);u[l*w+d]=v}for(var g=0;g<f;++g)for(var m=0;m<w;++m){for(var b=0,y=-2;y<=2;++y)for(var C=-2;C<=2;++C){var _=Math.max(0,Math.min(w-1,m+y));b+=u[Math.max(0,Math.min(f-1,g+C))*w+_]}e._applyThresholdToBlock(t,r,n,m,g,h,b/25,i)}}},{key:"_calculateBlockThreshold",value:function(t,r,n,i,o,a,s,h){for(var w=255,f=0,u=Math.min(i*s,r-s),l=Math.min(o*s,n-s)*r+u,c=0;c<s;++c){for(var d=0;d<s;++d){var v=t[l+d];v<w&&(w=v),v>f&&(f=v)}l+=r}if(f-w>e.MIN_DYNAMIC_RANGE)return(w+f)/2;if(0===i||0===o)return w/2;var g=o*a+i,m=(h[g-1]+h[g-a]+a[g-a-1])/3;return m>w?m:w/2}},{key:"_applyThresholdToBlock",value:function(e,t,r,n,i,o,a){for(var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:e,h=Math.min(n*o,t-o),w=Math.min(i*o,r-o)*t+h,f=0;f<o;++f){for(var u=0;u<o;++u){var l=w+u;s[l]=e[l]<=a}w+=t}}}]),e}();v.TARGET_BLOCK_COUNT_ALONG_SHORTER_SIDE=40,v.MIN_BLOCK_SIZE=16,v.MIN_DYNAMIC_RANGE=24;var g={};g.checkAndNudgePoints=function(e,t){for(var r=k.width,n=k.height,i=!0,o=0;o<t.length&&i;o+=2){var a=Math.floor(t[o]),s=Math.floor(t[o+1]);if(a<-1||a>r||s<-1||s>n)throw new Error("QR Error: Error.checkAndNudgePoints");i=!1,-1==a?(t[o]=0,i=!0):a==r&&(t[o]=r-1,i=!0),-1==s?(t[o+1]=0,i=!0):s==n&&(t[o+1]=n-1,i=!0)}i=!0;for(o=t.length-2;o>=0&&i;o-=2){var a=Math.floor(t[o]),s=Math.floor(t[o+1]);if(a<-1||a>r||s<-1||s>n)throw new Error("QR Error: Error.checkAndNudgePoints");i=!1,-1==a?(t[o]=0,i=!0):a==r&&(t[o]=r-1,i=!0),-1==s?(t[o+1]=0,i=!0):s==n&&(t[o+1]=n-1,i=!0)}},g.sampleGrid3=function(e,t,r){for(var n=new s(t),i=new Array(t<<1),o=0;o<t;o++){for(var a=i.length,h=o+.5,w=0;w<a;w+=2)i[w]=.5+(w>>1),i[w+1]=h;r.transformPoints1(i),g.checkAndNudgePoints(e,i);try{for(w=0;w<a;w+=2){e[Math.floor(i[w])+k.width*Math.floor(i[w+1])]&&n.set_Renamed(w>>1,o)}}catch(e){throw new Error("QR Error: Error.checkAndNudgePoints")}}return n},g.sampleGridx=function(e,t,r,i,o,a,s,h,w,f,u,l,c,d,v,m,b,y){var C=n.quadrilateralToQuadrilateral(r,i,o,a,s,h,w,f,u,l,c,d,v,m,b,y);return g.sampleGrid3(e,t,C)},r.VERSION_DECODE_INFO=new Array(31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017),r.VERSIONS=new Array(new r(1,new Array,new t(7,new e(1,19)),new t(10,new e(1,16)),new t(13,new e(1,13)),new t(17,new e(1,9))),new r(2,new Array(6,18),new t(10,new e(1,34)),new t(16,new e(1,28)),new t(22,new e(1,22)),new t(28,new e(1,16))),new r(3,new Array(6,22),new t(15,new e(1,55)),new t(26,new e(1,44)),new t(18,new e(2,17)),new t(22,new e(2,13))),new r(4,new Array(6,26),new t(20,new e(1,80)),new t(18,new e(2,32)),new t(26,new e(2,24)),new t(16,new e(4,9))),new r(5,new Array(6,30),new t(26,new e(1,108)),new t(24,new e(2,43)),new t(18,new e(2,15),new e(2,16)),new t(22,new e(2,11),new e(2,12))),new r(6,new Array(6,34),new t(18,new e(2,68)),new t(16,new e(4,27)),new t(24,new e(4,19)),new t(28,new e(4,15))),new r(7,new Array(6,22,38),new t(20,new e(2,78)),new t(18,new e(4,31)),new t(18,new e(2,14),new e(4,15)),new t(26,new e(4,13),new e(1,14))),new r(8,new Array(6,24,42),new t(24,new e(2,97)),new t(22,new e(2,38),new e(2,39)),new t(22,new e(4,18),new e(2,19)),new t(26,new e(4,14),new e(2,15))),new r(9,new Array(6,26,46),new t(30,new e(2,116)),new t(22,new e(3,36),new e(2,37)),new t(20,new e(4,16),new e(4,17)),new t(24,new e(4,12),new e(4,13))),new r(10,new Array(6,28,50),new t(18,new e(2,68),new e(2,69)),new t(26,new e(4,43),new e(1,44)),new t(24,new e(6,19),new e(2,20)),new t(28,new e(6,15),new e(2,16))),new r(11,new Array(6,30,54),new t(20,new e(4,81)),new t(30,new e(1,50),new e(4,51)),new t(28,new e(4,22),new e(4,23)),new t(24,new e(3,12),new e(8,13))),new r(12,new Array(6,32,58),new t(24,new e(2,92),new e(2,93)),new t(22,new e(6,36),new e(2,37)),new t(26,new e(4,20),new e(6,21)),new t(28,new e(7,14),new e(4,15))),new r(13,new Array(6,34,62),new t(26,new e(4,107)),new t(22,new e(8,37),new e(1,38)),new t(24,new e(8,20),new e(4,21)),new t(22,new e(12,11),new e(4,12))),new r(14,new Array(6,26,46,66),new t(30,new e(3,115),new e(1,116)),new t(24,new e(4,40),new e(5,41)),new t(20,new e(11,16),new e(5,17)),new t(24,new e(11,12),new e(5,13))),new r(15,new Array(6,26,48,70),new t(22,new e(5,87),new e(1,88)),new t(24,new e(5,41),new e(5,42)),new t(30,new e(5,24),new e(7,25)),new t(24,new e(11,12),new e(7,13))),new r(16,new Array(6,26,50,74),new t(24,new e(5,98),new e(1,99)),new t(28,new e(7,45),new e(3,46)),new t(24,new e(15,19),new e(2,20)),new t(30,new e(3,15),new e(13,16))),new r(17,new Array(6,30,54,78),new t(28,new e(1,107),new e(5,108)),new t(28,new e(10,46),new e(1,47)),new t(28,new e(1,22),new e(15,23)),new t(28,new e(2,14),new e(17,15))),new r(18,new Array(6,30,56,82),new t(30,new e(5,120),new e(1,121)),new t(26,new e(9,43),new e(4,44)),new t(28,new e(17,22),new e(1,23)),new t(28,new e(2,14),new e(19,15))),new r(19,new Array(6,30,58,86),new t(28,new e(3,113),new e(4,114)),new t(26,new e(3,44),new e(11,45)),new t(26,new e(17,21),new e(4,22)),new t(26,new e(9,13),new e(16,14))),new r(20,new Array(6,34,62,90),new t(28,new e(3,107),new e(5,108)),new t(26,new e(3,41),new e(13,42)),new t(30,new e(15,24),new e(5,25)),new t(28,new e(15,15),new e(10,16))),new r(21,new Array(6,28,50,72,94),new t(28,new e(4,116),new e(4,117)),new t(26,new e(17,42)),new t(28,new e(17,22),new e(6,23)),new t(30,new e(19,16),new e(6,17))),new r(22,new Array(6,26,50,74,98),new t(28,new e(2,111),new e(7,112)),new t(28,new e(17,46)),new t(30,new e(7,24),new e(16,25)),new t(24,new e(34,13))),new r(23,new Array(6,30,54,74,102),new t(30,new e(4,121),new e(5,122)),new t(28,new e(4,47),new e(14,48)),new t(30,new e(11,24),new e(14,25)),new t(30,new e(16,15),new e(14,16))),new r(24,new Array(6,28,54,80,106),new t(30,new e(6,117),new e(4,118)),new t(28,new e(6,45),new e(14,46)),new t(30,new e(11,24),new e(16,25)),new t(30,new e(30,16),new e(2,17))),new r(25,new Array(6,32,58,84,110),new t(26,new e(8,106),new e(4,107)),new t(28,new e(8,47),new e(13,48)),new t(30,new e(7,24),new e(22,25)),new t(30,new e(22,15),new e(13,16))),new r(26,new Array(6,30,58,86,114),new t(28,new e(10,114),new e(2,115)),new t(28,new e(19,46),new e(4,47)),new t(28,new e(28,22),new e(6,23)),new t(30,new e(33,16),new e(4,17))),new r(27,new Array(6,34,62,90,118),new t(30,new e(8,122),new e(4,123)),new t(28,new e(22,45),new e(3,46)),new t(30,new e(8,23),new e(26,24)),new t(30,new e(12,15),new e(28,16))),new r(28,new Array(6,26,50,74,98,122),new t(30,new e(3,117),new e(10,118)),new t(28,new e(3,45),new e(23,46)),new t(30,new e(4,24),new e(31,25)),new t(30,new e(11,15),new e(31,16))),new r(29,new Array(6,30,54,78,102,126),new t(30,new e(7,116),new e(7,117)),new t(28,new e(21,45),new e(7,46)),new t(30,new e(1,23),new e(37,24)),new t(30,new e(19,15),new e(26,16))),new r(30,new Array(6,26,52,78,104,130),new t(30,new e(5,115),new e(10,116)),new t(28,new e(19,47),new e(10,48)),new t(30,new e(15,24),new e(25,25)),new t(30,new e(23,15),new e(25,16))),new r(31,new Array(6,30,56,82,108,134),new t(30,new e(13,115),new e(3,116)),new t(28,new e(2,46),new e(29,47)),new t(30,new e(42,24),new e(1,25)),new t(30,new e(23,15),new e(28,16))),new r(32,new Array(6,34,60,86,112,138),new t(30,new e(17,115)),new t(28,new e(10,46),new e(23,47)),new t(30,new e(10,24),new e(35,25)),new t(30,new e(19,15),new e(35,16))),new r(33,new Array(6,30,58,86,114,142),new t(30,new e(17,115),new e(1,116)),new t(28,new e(14,46),new e(21,47)),new t(30,new e(29,24),new e(19,25)),new t(30,new e(11,15),new e(46,16))),new r(34,new Array(6,34,62,90,118,146),new t(30,new e(13,115),new e(6,116)),new t(28,new e(14,46),new e(23,47)),new t(30,new e(44,24),new e(7,25)),new t(30,new e(59,16),new e(1,17))),new r(35,new Array(6,30,54,78,102,126,150),new t(30,new e(12,121),new e(7,122)),new t(28,new e(12,47),new e(26,48)),new t(30,new e(39,24),new e(14,25)),new t(30,new e(22,15),new e(41,16))),new r(36,new Array(6,24,50,76,102,128,154),new t(30,new e(6,121),new e(14,122)),new t(28,new e(6,47),new e(34,48)),new t(30,new e(46,24),new e(10,25)),new t(30,new e(2,15),new e(64,16))),new r(37,new Array(6,28,54,80,106,132,158),new t(30,new e(17,122),new e(4,123)),new t(28,new e(29,46),new e(14,47)),new t(30,new e(49,24),new e(10,25)),new t(30,new e(24,15),new e(46,16))),new r(38,new Array(6,32,58,84,110,136,162),new t(30,new e(4,122),new e(18,123)),new t(28,new e(13,46),new e(32,47)),new t(30,new e(48,24),new e(14,25)),new t(30,new e(42,15),new e(32,16))),new r(39,new Array(6,26,54,82,110,138,166),new t(30,new e(20,117),new e(4,118)),new t(28,new e(40,47),new e(7,48)),new t(30,new e(43,24),new e(22,25)),new t(30,new e(10,15),new e(67,16))),new r(40,new Array(6,30,58,86,114,142,170),new t(30,new e(19,118),new e(6,119)),new t(28,new e(18,47),new e(31,48)),new t(30,new e(34,24),new e(34,25)),new t(30,new e(20,15),new e(61,16)))),r.getVersionForNumber=function(e){if(e<1||e>40)throw new Error("QR Error: ArgumentException");return r.VERSIONS[e-1]},r.getProvisionalVersionForDimension=function(e){if(e%4!=1)throw new Error("QR Error: Error getProvisionalVersionForDimension");try{return r.getVersionForNumber(e-17>>2)}catch(e){throw new Error("QR Error: Error getVersionForNumber")}},r.decodeVersionInformation=function(e){for(var t=4294967295,n=0,i=0;i<r.VERSION_DECODE_INFO.length;i++){var a=r.VERSION_DECODE_INFO[i];if(a==e)return this.getVersionForNumber(i+7);var s=o.numBitsDiffering(e,a);s<t&&(n=i+7,t=s)}return t<=3?this.getVersionForNumber(n):null},n.quadrilateralToQuadrilateral=function(e,t,r,n,i,o,a,s,h,w,f,u,l,c,d,v){var g=this.quadrilateralToSquare(e,t,r,n,i,o,a,s);return this.squareToQuadrilateral(h,w,f,u,l,c,d,v).times(g)},n.squareToQuadrilateral=function(e,t,r,i,o,a,s,h){var w=h-a,f=t-i+a-h;if(0==w&&0==f)return new n(r-e,o-r,e,i-t,a-i,t,0,0,1);var u=r-o,l=s-o,c=e-r+o-s,d=i-a,v=u*w-l*d,g=(c*w-l*f)/v,m=(u*f-c*d)/v;return new n(r-e+g*r,s-e+m*s,e,i-t+g*i,h-t+m*h,t,g,m,1)},n.quadrilateralToSquare=function(e,t,r,n,i,o,a,s){return this.squareToQuadrilateral(e,t,r,n,i,o,a,s).buildAdjoint()};var m=new Array(new Array(21522,0),new Array(20773,1),new Array(24188,2),new Array(23371,3),new Array(17913,4),new Array(16590,5),new Array(20375,6),new Array(19104,7),new Array(30660,8),new Array(29427,9),new Array(32170,10),new Array(30877,11),new Array(26159,12),new Array(25368,13),new Array(27713,14),new Array(26998,15),new Array(5769,16),new Array(5054,17),new Array(7399,18),new Array(6608,19),new Array(1890,20),new Array(597,21),new Array(3340,22),new Array(2107,23),new Array(13663,24),new Array(12392,25),new Array(16177,26),new Array(14854,27),new Array(9396,28),new Array(8579,29),new Array(11994,30),new Array(11245,31)),b=new Array(0,1,1,2,1,2,2,3,1,2,2,3,2,3,3,4);o.numBitsDiffering=function(e,t){return e^=t,b[15&e]+b[15&u(e,4)]+b[15&u(e,8)]+b[15&u(e,12)]+b[15&u(e,16)]+b[15&u(e,20)]+b[15&u(e,24)]+b[15&u(e,28)]},o.decodeFormatInformation=function(e){var t=o.doDecodeFormatInformation(e);return null!=t?t:o.doDecodeFormatInformation(21522^e)},o.doDecodeFormatInformation=function(e){for(var t=4294967295,r=0,n=0;n<m.length;n++){var i=m[n],a=i[0];if(a==e)return new o(i[1]);var s=this.numBitsDiffering(e,a);s<t&&(r=i[1],t=s)}return t<=3?new o(r):null},a.forBits=function(e){if(e<0||e>=p.length)throw new Error("QR Error: ArgumentException");return p[e]};var y=new a(0,1,"L"),C=new a(1,0,"M"),_=new a(2,3,"Q"),A=new a(3,2,"H"),p=new Array(C,y,A,_);h.getDataBlocks=function(e,t,r){if(e.length!=t.TotalCodewords)throw new Error("QR Error: ArgumentException");for(var n=t.getECBlocksForLevel(r),i=0,o=n.getECBlocks(),a=0;a<o.length;a++)i+=o[a].Count;for(var s=new Array(i),w=0,f=0;f<o.length;f++)for(var u=o[f],a=0;a<u.Count;a++){var l=u.DataCodewords,c=n.ECCodewordsPerBlock+l;s[w++]=new h(l,new Array(c))}for(var d=s[0].codewords.length,v=s.length-1;v>=0;){if(s[v].codewords.length==d)break;v--}v++;for(var g=d-n.ECCodewordsPerBlock,m=0,a=0;a<g;a++)for(f=0;f<w;f++)s[f].codewords[a]=e[m++];for(f=v;f<w;f++)s[f].codewords[g]=e[m++];for(var b=s[0].codewords.length,a=g;a<b;a++)for(f=0;f<w;f++){var y=f<v?a:a+1;s[f].codewords[y]=e[m++]}return s};var M={};M.forReference=function(e){if(e<0||e>7)throw new Error("QR Error: System.ArgumentException");return M.DATA_MASKS[e]},M.DATA_MASKS=new Array(new function(){this.unmaskBitMatrix=function(e,t){for(var r=0;r<t;r++)for(var n=0;n<t;n++)this.isMasked(r,n)&&e.flip(n,r)},this.isMasked=function(e,t){return 0==(e+t&1)}},new function(){this.unmaskBitMatrix=function(e,t){for(var r=0;r<t;r++)for(var n=0;n<t;n++)this.isMasked(r,n)&&e.flip(n,r)},this.isMasked=function(e,t){return 0==(1&e)}},new function(){this.unmaskBitMatrix=function(e,t){for(var r=0;r<t;r++)for(var n=0;n<t;n++)this.isMasked(r,n)&&e.flip(n,r)},this.isMasked=function(e,t){return t%3==0}},new function(){this.unmaskBitMatrix=function(e,t){for(var r=0;r<t;r++)for(var n=0;n<t;n++)this.isMasked(r,n)&&e.flip(n,r)},this.isMasked=function(e,t){return(e+t)%3==0}},new function(){this.unmaskBitMatrix=function(e,t){for(var r=0;r<t;r++)for(var n=0;n<t;n++)this.isMasked(r,n)&&e.flip(n,r)},this.isMasked=function(e,t){return 0==(u(e,1)+t/3&1)}},new function(){this.unmaskBitMatrix=function(e,t){for(var r=0;r<t;r++)for(var n=0;n<t;n++)this.isMasked(r,n)&&e.flip(n,r)},this.isMasked=function(e,t){var r=e*t;return(1&r)+r%3==0}},new function(){this.unmaskBitMatrix=function(e,t){for(var r=0;r<t;r++)for(var n=0;n<t;n++)this.isMasked(r,n)&&e.flip(n,r)},this.isMasked=function(e,t){var r=e*t;return 0==((1&r)+r%3&1)}},new function(){this.unmaskBitMatrix=function(e,t){for(var r=0;r<t;r++)for(var n=0;n<t;n++)this.isMasked(r,n)&&e.flip(n,r)},this.isMasked=function(e,t){return 0==((e+t&1)+e*t%3&1)}}),f.QR_CODE_FIELD=new f(285),f.DATA_MATRIX_FIELD=new f(301),f.addOrSubtract=function(e,t){return e^t};var E={};E.rsDecoder=new function(e){this.field=e,this.decode=function(e,t){for(var r=new w(this.field,e),n=new Array(t),i=0;i<n.length;i++)n[i]=0;for(var o=!0,i=0;i<t;i++){var a=r.evaluateAt(this.field.exp(i));n[n.length-1-i]=a,0!=a&&(o=!1)}if(!o)for(var s=new w(this.field,n),h=this.runEuclideanAlgorithm(this.field.buildMonomial(t,1),s,t),u=h[0],l=h[1],c=this.findErrorLocations(u),d=this.findErrorMagnitudes(l,c,!1),i=0;i<c.length;i++){var v=e.length-1-this.field.log(c[i]);if(v<0)throw new Error("QR Error: ReedSolomonException Bad error location");e[v]=f.addOrSubtract(e[v],d[i])}},this.runEuclideanAlgorithm=function(e,t,r){if(e.Degree<t.Degree){var n=e;e=t,t=n}for(var i=e,o=t,a=this.field.One,s=this.field.Zero,h=this.field.Zero,w=this.field.One;o.Degree>=Math.floor(r/2);){var f=i,u=a,l=h;if(i=o,a=s,h=w,i.Zero)throw new Error("QR Error: r_{i-1} was zero");o=f;for(var c=this.field.Zero,d=i.getCoefficient(i.Degree),v=this.field.inverse(d);o.Degree>=i.Degree&&!o.Zero;){var g=o.Degree-i.Degree,m=this.field.multiply(o.getCoefficient(o.Degree),v);c=c.addOrSubtract(this.field.buildMonomial(g,m)),o=o.addOrSubtract(i.multiplyByMonomial(g,m))}s=c.multiply1(a).addOrSubtract(u),w=c.multiply1(h).addOrSubtract(l)}var b=w.getCoefficient(0);if(0==b)throw new Error("QR Error: ReedSolomonException sigmaTilde(0) was zero");var y=this.field.inverse(b),C=w.multiply2(y),_=o.multiply2(y);return new Array(C,_)},this.findErrorLocations=function(e){var t=e.Degree;if(1==t)return new Array(e.getCoefficient(1));for(var r=new Array(t),n=0,i=1;i<256&&n<t;i++)0==e.evaluateAt(i)&&(r[n]=this.field.inverse(i),n++);if(n!=t)throw new Error("QR Error: Error locator degree does not match number of roots");return r},this.findErrorMagnitudes=function(e,t,r){for(var n=t.length,i=new Array(n),o=0;o<n;o++){for(var a=this.field.inverse(t[o]),s=1,h=0;h<n;h++)o!=h&&(s=this.field.multiply(s,f.addOrSubtract(1,this.field.multiply(t[h],a))));i[o]=this.field.multiply(e.evaluateAt(a),this.field.inverse(s)),r&&(i[o]=this.field.multiply(i[o],a))}return i}}(f.QR_CODE_FIELD),E.correctErrors=function(e,t){for(var r=e.length,n=new Array(r),i=0;i<r;i++)n[i]=255&e[i];var o=e.length-t;try{E.rsDecoder.decode(n,o)}catch(e){throw e}for(i=0;i<t;i++)e[i]=n[i]},E.decode=function(e){for(var t=new function(e){var t=e.Dimension;if(t<21||1!=(3&t))throw new Error("QR Error: Error BitMatrixParser");this.bitMatrix=e,this.parsedVersion=null,this.parsedFormatInfo=null,this.copyBit=function(e,t,r){return this.bitMatrix.get_Renamed(e,t)?r<<1|1:r<<1},this.readFormatInformation=function(){if(null!=this.parsedFormatInfo)return this.parsedFormatInfo;for(var e=0,t=0;t<6;t++)e=this.copyBit(t,8,e);for(e=this.copyBit(7,8,e),e=this.copyBit(8,8,e),e=this.copyBit(8,7,e),i=5;i>=0;i--)e=this.copyBit(8,i,e);if(this.parsedFormatInfo=o.decodeFormatInformation(e),null!=this.parsedFormatInfo)return this.parsedFormatInfo;var r=this.bitMatrix.Dimension;e=0;for(var n=r-8,t=r-1;t>=n;t--)e=this.copyBit(t,8,e);for(var i=r-7;i<r;i++)e=this.copyBit(8,i,e);if(this.parsedFormatInfo=o.decodeFormatInformation(e),null!=this.parsedFormatInfo)return this.parsedFormatInfo;throw new Error("QR Error: Error readFormatInformation")},this.readVersion=function(){if(null!=this.parsedVersion)return this.parsedVersion;var e=this.bitMatrix.Dimension,t=e-17>>2;if(t<=6)return r.getVersionForNumber(t);for(var n=0,i=e-11,o=5;o>=0;o--)for(a=e-9;a>=i;a--)n=this.copyBit(a,o,n);if(this.parsedVersion=r.decodeVersionInformation(n),null!=this.parsedVersion&&this.parsedVersion.DimensionForVersion==e)return this.parsedVersion;n=0;for(var a=5;a>=0;a--)for(o=e-9;o>=i;o--)n=this.copyBit(a,o,n);if(this.parsedVersion=r.decodeVersionInformation(n),null!=this.parsedVersion&&this.parsedVersion.DimensionForVersion==e)return this.parsedVersion;throw new Error("QR Error: Error readVersion")},this.readCodewords=function(){var e=this.readFormatInformation(),t=this.readVersion(),r=M.forReference(e.DataMask),n=this.bitMatrix.Dimension;r.unmaskBitMatrix(this.bitMatrix,n);for(var i=t.buildFunctionPattern(),o=!0,a=new Array(t.TotalCodewords),s=0,h=0,w=0,f=n-1;f>0;f-=2){6==f&&f--;for(var u=0;u<n;u++)for(var l=o?n-1-u:u,c=0;c<2;c++)i.get_Renamed(f-c,l)||(w++,h<<=1,this.bitMatrix.get_Renamed(f-c,l)&&(h|=1),8==w&&(a[s++]=h,w=0,h=0));o^=!0}if(s!=t.TotalCodewords)throw new Error("QR Error: Error readCodewords");return a}}(e),n=t.readVersion(),i=t.readFormatInformation().ErrorCorrectionLevel,a=t.readCodewords(),s=h.getDataBlocks(a,n,i),w=0,f=0;f<s.length;f++)w+=s[f].NumDataCodewords;for(var u=new Array(w),l=0,c=0;c<s.length;c++){var d=s[c],v=d.Codewords,g=d.NumDataCodewords;E.correctErrors(v,g);for(f=0;f<g;f++)u[l++]=v[f]}return new function(e,t,r){this.blockPointer=0,this.bitPointer=7,this.dataLength=0,this.blocks=e,this.numErrorCorrectionCode=r,t<=9?this.dataLengthMode=0:t>=10&&t<=26?this.dataLengthMode=1:t>=27&&t<=40&&(this.dataLengthMode=2),this.getNextBits=function(e){var t=0;if(e<this.bitPointer+1){for(var r=0,n=0;n<e;n++)r+=1<<n;return r<<=this.bitPointer-e+1,t=(this.blocks[this.blockPointer]&r)>>this.bitPointer-e+1,this.bitPointer-=e,t}if(e<this.bitPointer+1+8){for(var i=0,n=0;n<this.bitPointer+1;n++)i+=1<<n;return t=(this.blocks[this.blockPointer]&i)<<e-(this.bitPointer+1),this.blockPointer++,t+=this.blocks[this.blockPointer]>>8-(e-(this.bitPointer+1)),this.bitPointer=this.bitPointer-e%8,this.bitPointer<0&&(this.bitPointer=8+this.bitPointer),t}if(e<this.bitPointer+1+16){for(var i=0,o=0,n=0;n<this.bitPointer+1;n++)i+=1<<n;var a=(this.blocks[this.blockPointer]&i)<<e-(this.bitPointer+1);this.blockPointer++;var s=this.blocks[this.blockPointer]<<e-(this.bitPointer+1+8);for(this.blockPointer++,n=0;n<e-(this.bitPointer+1+8);n++)o+=1<<n;return o<<=8-(e-(this.bitPointer+1+8)),t=a+s+((this.blocks[this.blockPointer]&o)>>8-(e-(this.bitPointer+1+8))),this.bitPointer=this.bitPointer-(e-8)%8,this.bitPointer<0&&(this.bitPointer=8+this.bitPointer),t}return 0},this.NextMode=function(){return this.blockPointer>this.blocks.length-this.numErrorCorrectionCode-2?0:this.getNextBits(4)},this.getDataLength=function(e){for(var t=0;e>>t!=1;)t++;return this.getNextBits(k.sizeOfDataLengthInfo[this.dataLengthMode][t])},this.getRomanAndFigureString=function(e){var t=e,r=0,n="",i=new Array("0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":");do{if(t>1){var o=(r=this.getNextBits(11))%45;n+=i[Math.floor(r/45)],n+=i[o],t-=2}else 1==t&&(n+=i[r=this.getNextBits(6)],t-=1)}while(t>0);return n},this.getFigureString=function(e){var t=e,r=0,n="";do{t>=3?((r=this.getNextBits(10))<100&&(n+="0"),r<10&&(n+="0"),t-=3):2==t?((r=this.getNextBits(7))<10&&(n+="0"),t-=2):1==t&&(r=this.getNextBits(4),t-=1),n+=r}while(t>0);return n},this.get8bitByteArray=function(e){var t=e,r=0,n=new Array;do{r=this.getNextBits(8),n.push(r),t--}while(t>0);return n},this.getKanjiString=function(e){var t=e,r=0,n="";do{var i=((r=this.getNextBits(13))/192<<8)+r%192,o=0;o=i+33088<=40956?i+33088:i+49472,n+=String.fromCharCode(o),t--}while(t>0);return n},this.parseECIValue=function(){var e=0,t=this.getNextBits(8);return 0==(128&t)&&(e=127&t),128==(192&t)&&(e=(63&t)<<8|this.getNextBits(8)),192==(224&t)&&(e=(31&t)<<16|this.getNextBits(8)),e},this.__defineGetter__("DataByte",function(){for(var e=new Array;;){var t=this.NextMode();if(0==t){if(e.length>0)break;throw new Error("QR Error: Empty data block")}if(1!=t&&2!=t&&4!=t&&8!=t&&7!=t)throw new Error("QR Error: Invalid mode: "+t+" in (block:"+this.blockPointer+" bit:"+this.bitPointer+")");if(7==t)a=this.parseECIValue();else{var r=this.getDataLength(t);if(r<1)throw new Error("QR Error: Invalid data length: "+r);switch(t){case 1:for(var n=this.getFigureString(r),i=new Array(n.length),o=0;o<n.length;o++)i[o]=n.charCodeAt(o);e.push(i);break;case 2:for(var n=this.getRomanAndFigureString(r),i=new Array(n.length),o=0;o<n.length;o++)i[o]=n.charCodeAt(o);e.push(i);break;case 4:var a=this.get8bitByteArray(r);e.push(a);break;case 8:n=this.getKanjiString(r),e.push(n)}}}return e})}(u,n.VersionNumber,i.Bits)};var k={};k.imagedata=null,k.width=0,k.height=0,k.qrCodeSymbol=null,k.debug=!1,k.maxImgSize=1048576,k.sizeOfDataLengthInfo=[[10,9,8,8],[12,11,16,10],[14,13,16,12]],k.callback=null,k.decode=function(e){if(0==arguments.length){if(k.canvas_qr2)var t=k.canvas_qr2,r=k.qrcontext2;else r=(t=document.getElementById("qr-canvas")).getContext("2d");return k.width=t.width,k.height=t.height,k.imagedata=r.getImageData(0,0,k.width,k.height),k.result=k.process(r),null!=k.callback&&k.callback(k.result),k.result}var n=new Image;n.crossOrigin="Anonymous",n.onload=function(){var e=document.getElementById("out-canvas");if(null!=e){var t=e.getContext("2d");t.clearRect(0,0,320,240),t.drawImage(n,0,0,320,240)}var r=document.createElement("canvas"),i=r.getContext("2d"),o=n.height,a=n.width;if(n.width*n.height>k.maxImgSize){var s=n.width/n.height;a=s*(o=Math.sqrt(k.maxImgSize/s))}r.width=a,r.height=o,i.drawImage(n,0,0,r.width,r.height),k.width=r.width,k.height=r.height;try{k.imagedata=i.getImageData(0,0,r.width,r.height)}catch(e){return k.result="Cross domain image reading not supported in your browser! Save it to your computer then drag and drop the file!",void(null!=k.callback&&k.callback(k.result))}try{k.result=k.process(i)}catch(e){console.log(e),k.result="error decoding QR Code"}null!=k.callback&&k.callback(k.result)},n.onerror=function(){null!=k.callback&&k.callback("Failed to load the image")},n.src=e},k.isUrl=function(e){return/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(e)},k.decode_url=function(e){var t="";try{t=escape(e)}catch(r){console.log(r),t=e}var r="";try{r=decodeURIComponent(t)}catch(e){console.log(e),r=t}return r},k.decode_utf8=function(e){return k.isUrl(e)?k.decode_url(e):e},k.process=function(e){var t=k.imagedata.data,r=0,n=new Uint8ClampedArray(t.buffer,r,k.width*k.height);r+=k.width*k.height;var o=new Uint8ClampedArray(t.buffer,r,k.width*k.height);r+=k.width*k.height;var a=v.calculateRequiredBufferSize(k.width,k.height),s=new Uint8ClampedArray(t.buffer,r,a);k.grayscale(t,k.width,k.height,n),v.binarize(n,k.width,k.height,o,s);var h;if(k.debug){h=new ImageData(new Uint8ClampedArray(k.width*k.height*4),k.width,k.height);for(l=0;l<k.height;l++)for(c=0;c<k.width;c++){var w=4*c+l*k.width*4,f=o[l*k.width+c]?0:255;h.data[w]=f,h.data[w+1]=f,h.data[w+2]=f,h.data[w+3]=255}e.putImageData(h,0,0)}var u=new i(o).detect();if(k.debug){for(var l=0;l<u.bits.Height;l++)for(var c=0;c<u.bits.Width;c++){var w=4*c*2+2*l*k.width*4,d=u.bits.get_Renamed(c,l);h.data[w]=d?0:255,h.data[w+1]=d?0:255,h.data[w+2]=255}e.putImageData(h,0,0)}for(var g=E.decode(u.bits).DataByte,m="",b=0;b<g.length;b++)for(var y=0;y<g[b].length;y++)m+=String.fromCharCode(g[b][y]);return k.decode_utf8(m)},k.getMiddleBrightnessPerArea=function(e){for(var t=Math.floor(k.width/4),r=Math.floor(k.height/4),n=new Array(4),i=0;i<4;i++){n[i]=new Array(4);for(var o=0;o<4;o++)n[i][o]=new Array(0,0)}for(u=0;u<4;u++)for(l=0;l<4;l++){n[l][u][0]=255;for(var a=0;a<r;a++)for(var s=0;s<t;s++){var h=e[t*l+s+(r*u+a)*k.width];h<n[l][u][0]&&(n[l][u][0]=h),h>n[l][u][1]&&(n[l][u][1]=h)}}for(var w=new Array(4),f=0;f<4;f++)w[f]=new Array(4);for(var u=0;u<4;u++)for(var l=0;l<4;l++)w[l][u]=Math.floor((n[l][u][0]+n[l][u][1])/2);return w},k.grayScaleToBitmap=function(e){for(var t=k.getMiddleBrightnessPerArea(e),r=t.length,n=Math.floor(k.width/r),i=Math.floor(k.height/r),o=new ArrayBuffer(k.width*k.height),a=new Uint8Array(o),s=0;s<r;s++)for(var h=0;h<r;h++)for(var w=0;w<i;w++)for(var f=0;f<n;f++)a[n*h+f+(i*s+w)*k.width]=e[n*h+f+(i*s+w)*k.width]<t[h][s];return a},k.grayscale=function(e,t,r,n){for(var i=0;i<r;i++)for(var o=0;o<t;o++){var a=i*t+o,s=4*a;n[a]=77*e[s]+150*e[s+1]+29*e[s+2]+128>>8}},window.qrscanner=k;var B=3,N=57,S=8,P=2;k.orderBestPatterns=function(e){function t(e,t){var r=e.X-t.X,n=e.Y-t.Y;return Math.sqrt(r*r+n*n)}var r,n,i,o=t(e[0],e[1]),a=t(e[1],e[2]),s=t(e[0],e[2]);if(a>=o&&a>=s?(n=e[0],r=e[1],i=e[2]):s>=a&&s>=o?(n=e[1],r=e[0],i=e[2]):(n=e[2],r=e[0],i=e[1]),function(e,t,r){var n=t.x,i=t.y;return(r.x-n)*(e.y-i)-(r.y-i)*(e.x-n)}(r,n,i)<0){var h=r;r=i,i=h}e[0]=r,e[1]=n,e[2]=i}}();
//# sourceMappingURL=qr-scanner-lib.min.js.map
